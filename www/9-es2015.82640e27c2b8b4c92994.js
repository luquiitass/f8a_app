(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{XDjf:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var o=i("mrSG"),n=i("4R65"),s=i("8xVP"),a=i("fXoL"),c=i("G/jy"),l=i("Bfh1"),r=i("m/P+"),d=i("ofXK"),b=i("TEn/");function h(e,t){if(1&e){const e=a.Rb();a.Qb(0,"div",2),a.Qb(1,"ion-button",3),a.Yb("click",(function(){return a.oc(e),a.ac().shareW()})),a.Mb(2,"ion-icon",4),a.vc(3," Enviar ubicaci\xf3n "),a.Pb(),a.Qb(4,"ion-button",3),a.Yb("click",(function(){return a.oc(e),a.ac().getRoute()})),a.Mb(5,"ion-icon",5),a.vc(6," Como llegar "),a.Pb(),a.Pb()}}let m=(()=>{class e{constructor(e,t,i){this.request=e,this.geolocation=t,this.iab=i,this.showDirection=!1,this.newMarker=null,this.position={lat:0,lng:0},this.modelField=new s.a("Field",e)}ngOnInit(){return Object(o.b)(this,void 0,void 0,(function*(){this.loadField(),this.getLocation()}))}loadField(){console.log("load field"),this.id&&this.modelField.api_find(this.id).subscribe(e=>{"success"==e.status&&(this.field=e.Field,this.reset(),this.leafletMap(),this.refresh())})}getLocation(){return Object(o.b)(this,void 0,void 0,(function*(){console.log("get position"),yield this.geolocation.getCurrentPosition({timeout:6e3}).then(e=>{console.log("resp geo",e),this.position.lat=e.coords.latitude,this.position.lng=e.coords.longitude}).catch(e=>{console.error("error geo ",e)}),this.geolocation.watchPosition().subscribe(e=>{console.log("data geo",e)})}))}getRoute(){return Object(o.b)(this,void 0,void 0,(function*(){this.comoLlegar()}))}leafletMap(){this.map=n.map("mapId").setView([this.field.lat,this.field.lng],11),this.map.on("load",()=>{console.log("load map"),this.refresh()}),this.map.on("locationfound",e=>{console.log("loc found ",e)}),this.map.on("locationerror",e=>{console.log("loc error ",e)}),n.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"futbol8alem.com",id:"mapbox/streets-v11"}).addTo(this.map);var e=n.icon({iconUrl:"http://icons.iconseeker.com/png/fullsize/sport-fields/football-field.png",iconSize:[30,40],iconAnchor:[15,40],shadowSize:[35,50],shadowAnchor:[0,55],popupAnchor:[0,-40]});n.marker([this.field.lat,this.field.lng],{icon:e}).addTo(this.map).bindPopup(this.field.name,{permanent:!0}).openPopup(),this.refresh()}ngOnChanges(e){console.log("changes"),e.field&&setTimeout(()=>{this.map&&(this.map.off(),this.map.remove()),this.leafletMap()})}refresh(){setTimeout(()=>{this.map.invalidateSize()},1e3)}reset(){this.map&&(this.map.off(),this.map.remove())}ionViewDidLeave(){console.log("ionViewDidLeave component show-map"),this.reset()}comoLlegar(){this.iab.create(`https://www.google.com/maps/dir/?api=1&destination=${this.field.lat},${this.field.lng}`,"",{fullscreen:"yes"})}shareW(){let e=encodeURIComponent(`https://www.google.com/maps/dir/?api=1&destination=${this.field.lat},${this.field.lng}`);this.iab.create("https://api.whatsapp.com/send?text="+e,"",{fullscreen:"yes"})}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(c.a),a.Lb(l.a),a.Lb(r.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["app-show-map"]],inputs:{field:"field",showDirection:"showDirection",id:"id"},features:[a.wb],decls:2,vars:4,consts:[["id","mapId"],["class","ion-text-right",4,"ngIf"],[1,"ion-text-right"],[3,"click"],["name","logo-whatsapp"],["name","navigate-outline"]],template:function(e,t){1&e&&(a.Mb(0,"div",0),a.uc(1,h,7,0,"div",1)),2&e&&(a.sc("width: 100%; height: ",t.field?"300":"0","px;"),a.yb(1),a.gc("ngIf",t.showDirection&&t.field))},directives:[d.l,b.i,b.y],styles:[""]}),e})()},fSJy:function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var o=i("mrSG"),n=i("8xVP"),s=i("9suA"),a=i("4R65"),c=i("fXoL"),l=i("G/jy"),r=i("vuFD"),d=i("TEn/"),b=i("6/gD"),h=i("ofXK"),m=i("3Pt+");let u=(()=>{class e extends s.a{constructor(e,t,i,o,s,a){super(a,i),this.request=e,this.dialogService=t,this.viewCtrl=i,this.photoService=o,this.newMarker=null,this.modelField=new n.a("Field",e),this.id=s.get("id")}initObject(){console.log("initObject"),this.field={name:"",lat:-27.603857971720405,lng:-55.323644024643414},navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{this.field.lat=e.coords.latitude,this.field.lng=e.coords.longitude,console.log("current pos",e)},e=>{console.error(e)}),this.id?this.modelField.api_find(this.id).subscribe(e=>{console.log("load field",e),"success"==e.status&&(this.field=e.Field,this.leafletMap(),this.addNewMarker())}):this.leafletMap()}submit(){this.field.id?this.modelField.api_update(this.field).subscribe(e=>{var t;"success"==e.status&&(this.dialogService.showToast(null!==(t=e.msjSuccess)&&void 0!==t?t:"Registrado"),this.dismiss(e.Field))}):this.modelField.api_create(this.field).subscribe(e=>{var t;"success"==e.status&&(this.dialogService.showToast(null!==(t=e.msjSuccess)&&void 0!==t?t:"Registrado"),this.dismiss(e.Field))})}dismiss(e){this.viewCtrl.dismiss({field:e})}close(){this.viewCtrl.dismiss()}leafletMap(){this.reset(),this.map=a.map("mapId2"),this.map.on("load",()=>{console.log("load map"),setTimeout(()=>{console.log("refresh"),this.regresh()},1e3)}),this.map.setView([this.field.lat,this.field.lng],11),a.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"futbol8alem.com",id:"mapbox/streets-v11"}).addTo(this.map),this.map.on("contextmenu",e=>{console.log("rightClick",e),this.field.lat=e.latlng.lat,this.field.lng=e.latlng.lng,this.addNewMarker()}),this.loadFields()}addNewMarker(){this.newMarker&&this.map.removeLayer(this.newMarker);const e=a.divIcon({className:"my-custom-pin",iconAnchor:[0,24],labelAnchor:[-6,0],popupAnchor:[0,-36],html:'<span style="\n      background-color: #35da7f;\n      width: 2rem;\n      height: 2rem;\n      display: block;\n      left: -1.5rem;\n      top: -1.5rem;\n      position: relative;\n      border-radius: 3rem 3rem 0;\n      transform: rotate(45deg);\n      border: 1px solid #FFFFFF" />'});this.newMarker=a.marker([this.field.lat,this.field.lng],{draggable:!0,alt:"Nueva Cancha",shadowPane:"Pane",icon:e,title:"Arrastra bara canbiar la ubicaci\xf3n."}).addTo(this.map),this.newMarker.on("dragend",e=>{var t=e.target,i=t.getLatLng();this.field.lat=i.lat,this.field.lng=i.lng,t.openPopup(),console.log("change pos",this.field)}),this.newMarker.bindPopup(this.field.name,{autoPan:!1}).openPopup()}loadFields(){return Object(o.b)(this,void 0,void 0,(function*(){this.id||this.modelField.api_function("markers").subscribe(e=>{"success"==e.status&&e.data&&e.data.forEach(e=>{this.addMarker(parseFloat(e.lat),parseFloat(e.lng),e.name)}),this.map.setView([this.field.lat,this.field.lng],11)},e=>{})}))}addMarker(e,t,i){var o=a.icon({iconUrl:"http://icons.iconseeker.com/png/fullsize/sport-fields/football-field.png",iconSize:[30,40],iconAnchor:[15,40],shadowSize:[35,50],shadowAnchor:[0,55],popupAnchor:[0,-40]});0!=e&&0!=t&&a.marker([e,t],{icon:o}).addTo(this.map).bindTooltip(i,{permanent:!0}).openTooltip()}inputVal(e){this.field.name=e,this.newMarker&&this.newMarker._popup.setContent(e,{autoPan:!1})}regresh(){this.map.invalidateSize()}reset(){this.map&&(this.map.off(),this.map.remove())}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(l.a),c.Lb(r.a),c.Lb(d.nb),c.Lb(b.a),c.Lb(d.pb),c.Lb(h.n))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-field-form"]],features:[c.vb],decls:26,vars:2,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],[3,"ngSubmit","keyup"],[1,"info"],[1,"sug"],["position","floating"],["type","text","name","name",3,"value","input"],[2,"color","red","padding-top","0.2rem"],["id","mapId2",2,"min-width","100%","min-height","400px !important"],[1,"desc"],["expand","block",3,"click"]],template:function(e,t){1&e&&(c.Qb(0,"ion-header"),c.Qb(1,"ion-toolbar"),c.Qb(2,"ion-title"),c.vc(3,"Cancha"),c.Pb(),c.Qb(4,"ion-buttons",0),c.Qb(5,"ion-button",1),c.Yb("click",(function(){return t.close()})),c.Mb(6,"ion-icon",2),c.Pb(),c.Pb(),c.Pb(),c.Pb(),c.Qb(7,"ion-content"),c.Qb(8,"form",3),c.Yb("ngSubmit",(function(){return t.submit()}))("keyup",(function(){return t.modelField.errorsForm.clear()})),c.Qb(9,"div",4),c.vc(10," Ingrese un nombre para identificar la cancha "),c.Qb(11,"span",5),c.vc(12," (Recomendamos el NOMBRE DEL EQUIPO que utiliza la cancha o el NOMBRE DEL LUGAR donde se encuentra ubicado)"),c.Pb(),c.vc(13,", despu\xe9s seleccione la ubicaci\xf3n en el mapa. "),c.Pb(),c.Qb(14,"ion-item"),c.Qb(15,"ion-label",6),c.vc(16,"Nombre"),c.Pb(),c.Qb(17,"ion-input",7),c.Yb("input",(function(e){return t.inputVal(e.target.value)})),c.Pb(),c.Pb(),c.Qb(18,"div",8),c.vc(19),c.Pb(),c.Mb(20,"br"),c.Mb(21,"div",9),c.Qb(22,"div",10),c.vc(23," Mant\xe9n presionado la ubicaci\xf3n en el mapa para a\xf1adir la ubicaci\xf3n. "),c.Pb(),c.Qb(24,"ion-button",11),c.Yb("click",(function(){return t.submit()})),c.vc(25,"Guardar"),c.Pb(),c.Pb(),c.Pb()),2&e&&(c.yb(17),c.gc("value",t.field.name),c.yb(2),c.wc(t.modelField.errorsForm.get("name")))},directives:[d.x,d.jb,d.hb,d.j,d.i,d.y,d.r,m.i,m.e,m.f,d.D,d.G,d.C,d.vb],styles:["#mapId[_ngcontent-%COMP%], #mapId2[_ngcontent-%COMP%]{min-width:100%!important;min-height:300px!important}.desc[_ngcontent-%COMP%]{margin:10px}.info[_ngcontent-%COMP%]{color:#babdbf;margin:15px}.sug[_ngcontent-%COMP%]{color:#727475}"]}),e})();var g=i("rLe3"),f=i("2Rin"),p=i("y/q6");function v(e,t){if(1&e){const e=c.Rb();c.Qb(0,"ion-button",3),c.Yb("click",(function(t){c.oc(e);const i=c.ac(2).$implicit;return c.ac().showEdit(i,t)})),c.Mb(1,"ion-icon",12),c.Pb()}}function P(e,t){if(1&e){const e=c.Rb();c.Qb(0,"ion-button",3),c.Yb("click",(function(t){c.oc(e);const i=c.ac(2).$implicit;return c.ac().confirmDelete(i,t)})),c.Mb(1,"ion-icon",13),c.Pb()}}function y(e,t){if(1&e&&(c.Qb(0,"ion-buttons",10),c.uc(1,v,2,0,"ion-button",11),c.uc(2,P,2,0,"ion-button",11),c.Pb()),2&e){const e=c.ac().$implicit,t=c.ac();c.yb(1),c.gc("ngIf",!e.team_id),c.yb(1),c.gc("ngIf",t.authUser.isAdmin())}}function w(e,t){if(1&e){const e=c.Rb();c.Qb(0,"ion-item",3),c.Yb("click",(function(){c.oc(e);const i=t.$implicit;return c.ac().dismiss(i)})),c.Qb(1,"label"),c.vc(2),c.Pb(),c.uc(3,y,3,2,"ion-buttons",9),c.Pb()}if(2&e){const e=t.$implicit,i=c.ac();c.yb(2),c.wc(e.name),c.yb(1),c.gc("ngIf",i.canEdit)}}function Q(e,t){1&e&&(c.Qb(0,"ion-item"),c.Qb(1,"label"),c.vc(2,"No se han encontrado registros"),c.Pb(),c.Pb())}let M=(()=>{class e extends s.a{constructor(e,t,i,o,s,a,c,l,r){super(a,c),this.requestService=e,this.dialogService=t,this.modalController=i,this.utilArray=o,this.util=s,this.viewCtrl=c,this.dialog=l,this.authUser=r,this.fields=[],this.oldFields=[],this.canEdit=!1,this.modelField=new n.a("Field",e)}ngOnInit(){this.util.setScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyA_uVKWprjIgPURNhl1v9zzTPLQJIBdi6I"),this.init()}init(){return Object(o.b)(this,void 0,void 0,(function*(){yield this.dialogService.loadingProgres(),this.modelField.api_function("pageAllFields").subscribe(e=>{"success"==e.status&&(this.fields=e.data,this.oldFields=this.fields),this.dialogService.dimissLoaging()},e=>{this.dialogService.dimissLoaging(),this.dialogService.showToast("Error al obtener Campos","","warning")})}))}add(){return Object(o.b)(this,void 0,void 0,(function*(){const e=yield this.modalController.create({component:u});return e.onDidDismiss().then(e=>{e.data&&e.data.field&&this.utilArray.listAddFirst(this.fields,e.data.field)}),yield e.present()}))}filterField(e){let t=e.target.value;t.length<=0?this.fields=this.oldFields:(this.fields=[...this.oldFields],this.fields=this.fields.filter(e=>e.name.toUpperCase().includes(t.toUpperCase())))}cancelFilter(e){this.fields=this.oldFields}dismiss(e){this.viewCtrl.dismiss({field:e})}close(){this.viewCtrl.dismiss()}confirmDelete(e,t){t.stopPropagation(),this.dialog.presentAlertConfirm("Confirmar","Estas seguro de eliminar esta cancha",t=>{this.delete(e)})}delete(e){this.modelField.api_delete(e.id).subscribe(t=>{console.log(t),"success"==t.status&&(this.dialog.showToast("Cancha Eliminada",null,"success"),this.utilArray.listDelete(this.fields,e.id))})}showEdit(e,t){return Object(o.b)(this,void 0,void 0,(function*(){console.log("showEdit"),t.stopPropagation();const i=yield this.modalController.create({component:u,componentProps:{id:e.id}});return i.onDidDismiss().then(e=>{if(e.data&&e.data.field){const t=e.data.field;this.utilArray.listUpdate(this.fields,t.id,t)}}),yield i.present()}))}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(l.a),c.Lb(r.a),c.Lb(d.nb),c.Lb(g.a),c.Lb(f.a),c.Lb(h.n),c.Lb(d.nb),c.Lb(r.a),c.Lb(p.a))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-list-fields"]],features:[c.vb],decls:16,vars:2,consts:[["slot","start"],["defaultHref","/home/teams",3,"click"],["slot","secondary"],[3,"click"],["name","create-outline"],["name","add-outline"],["placeholder","Filtrar Canchas","debounce","500",3,"keyup","ionClear"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["slot","end",4,"ngIf"],["slot","end"],[3,"click",4,"ngIf"],["slot","icon-only","name","create-outline"],["name","trash-outline"]],template:function(e,t){1&e&&(c.Qb(0,"ion-header"),c.Qb(1,"ion-toolbar"),c.Qb(2,"ion-title"),c.vc(3,"Canchas"),c.Pb(),c.Qb(4,"ion-buttons",0),c.Qb(5,"ion-back-button",1),c.Yb("click",(function(){return t.close()})),c.Pb(),c.Pb(),c.Qb(6,"ion-buttons",2),c.Qb(7,"ion-button",3),c.Yb("click",(function(){return t.canEdit=!t.canEdit})),c.Mb(8,"ion-icon",4),c.Pb(),c.Qb(9,"ion-button",3),c.Yb("click",(function(){return t.add()})),c.Mb(10,"ion-icon",5),c.Pb(),c.Pb(),c.Pb(),c.Pb(),c.Qb(11,"ion-content"),c.Qb(12,"ion-searchbar",6),c.Yb("keyup",(function(e){return t.filterField(e)}))("ionClear",(function(e){return t.cancelFilter(e)})),c.Pb(),c.Qb(13,"ion-list"),c.uc(14,w,4,2,"ion-item",7),c.uc(15,Q,3,0,"ion-item",8),c.Pb(),c.Pb()),2&e&&(c.yb(14),c.gc("ngForOf",t.fields),c.yb(1),c.gc("ngIf",0==t.fields.length))},directives:[d.x,d.jb,d.hb,d.j,d.f,d.g,d.i,d.y,d.r,d.T,d.vb,d.H,h.k,h.l,d.D],styles:[""]}),e})()},qq2r:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var o=i("9suA"),n=i("fXoL"),s=i("TEn/"),a=i("ofXK"),c=i("EbHZ");function l(e,t){1&e&&(n.Qb(0,"ion-list-header",6),n.Qb(1,"ion-label"),n.vc(2,"No se ha encontrado equipos"),n.Pb(),n.Pb())}function r(e,t){if(1&e&&(n.Qb(0,"ion-avatar",0),n.Mb(1,"ion-img",11),n.Pb()),2&e){const e=n.ac().$implicit;n.yb(1),n.gc("src",e.shield?e.shield.urlCompleteThumb:"assets/images/esc.png")}}function d(e,t){if(1&e){const e=n.Rb();n.Qb(0,"ion-item",7),n.Yb("click",(function(){n.oc(e);const i=t.$implicit;return n.ac().dismiss(i)})),n.uc(1,r,2,1,"ion-avatar",8),n.Qb(2,"ion-label"),n.Qb(3,"h3",9),n.vc(4),n.Pb(),n.Pb(),n.Mb(5,"ion-icon",10),n.Pb()}if(2&e){const e=t.$implicit;n.yb(1),n.gc("ngIf",-1!=e.id),n.yb(3),n.wc(-1==e.id?"Registrar Nuevo Equipo ":e.name)}}let b=(()=>{class e extends o.a{constructor(e,t,i){super(t,e),this.viewCtrl=e,this.location=t,this.dataTranfer=i,this.teams=[],this.oldTeams=[],this.textSearch="",this.teams=i.getData("teams"),this.oldTeams=[...this.teams]}initObject(){}dismiss(e){this.viewCtrl.dismiss({team:e})}close(){this.viewCtrl.dismiss()}filterTeams(e){e.length<=0?this.teams=this.oldTeams:(this.teams=[...this.oldTeams],this.teams=this.teams.filter(t=>t.name.toUpperCase().includes(e.toUpperCase())||-1==t.id))}getFilter(){return this.teams.filter(e=>e.name.toUpperCase().includes(this.textSearch.toUpperCase())||-1==e.id)}cancelFilter(e){this.teams=this.oldTeams}filterChangue(e){this.textSearch=e.detail.value}log(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(s.nb),n.Lb(a.n),n.Lb(c.a))},e.\u0275cmp=n.Fb({type:e,selectors:[["app-modal-filter"]],features:[n.vb],decls:12,vars:2,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["placeholder","Filtrar equipos",3,"ionClear","ionChange"],["color","tertiary",4,"ngIf"],["class","team-list",3,"click",4,"ngFor","ngForOf"],["color","tertiary"],[1,"team-list",3,"click"],["slot","start",4,"ngIf"],[1,"fs-team"],["name","chevron-forward-outline"],[3,"src"]],template:function(e,t){1&e&&(n.Qb(0,"ion-header"),n.Qb(1,"ion-toolbar"),n.Qb(2,"ion-buttons",0),n.Qb(3,"ion-button",1),n.Yb("click",(function(){return t.close()})),n.Mb(4,"ion-icon",2),n.Pb(),n.Pb(),n.Qb(5,"ion-title"),n.vc(6,"Buscar Equipo"),n.Pb(),n.Pb(),n.Pb(),n.Qb(7,"ion-content"),n.Qb(8,"ion-searchbar",3),n.Yb("ionClear",(function(e){return t.cancelFilter(e)}))("ionChange",(function(e){return t.filterChangue(e)})),n.Pb(),n.Qb(9,"ion-list"),n.uc(10,l,3,0,"ion-list-header",4),n.uc(11,d,6,2,"ion-item",5),n.Pb(),n.Pb()),2&e&&(n.yb(10),n.gc("ngIf",0==t.getFilter().length),n.yb(1),n.gc("ngForOf",t.getFilter()))},directives:[s.x,s.jb,s.j,s.i,s.y,s.hb,s.r,s.T,s.vb,s.H,a.l,a.k,s.I,s.G,s.D,s.e,s.z],styles:[""]}),e})()},z0x6:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var o=i("mrSG"),n=i("8xVP"),s=i("qq2r"),a=i("wd/R"),c=i("fSJy"),l=i("fXoL"),r=i("G/jy"),d=i("vuFD"),b=i("TEn/"),h=i("6/gD"),m=i("y/q6"),u=i("2Rin"),g=i("sjK5"),f=i("EbHZ"),p=i("ofXK"),v=i("3Pt+"),P=i("XDjf");function y(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-button",17),l.Yb("click",(function(){return l.oc(e),l.ac().chatService.toggle()})),l.Mb(1,"ion-icon",18),l.Pb()}if(2&e){const e=l.ac();l.gc("color",e.chatService.isVisible?"success":"")}}function w(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item"),l.Qb(1,"ion-label",19),l.vc(2,"Nombre de equipo nuevo"),l.Pb(),l.Qb(3,"ion-input",20),l.Yb("ngModelChange",(function(t){return l.oc(e),l.ac().game.other_team=t})),l.Pb(),l.Pb()}if(2&e){const e=l.ac();l.yb(3),l.gc("ngModel",e.game.other_team)}}function Q(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item"),l.Qb(1,"ion-label",19),l.vc(2,"Equipo Local"),l.Pb(),l.Qb(3,"ion-select",21),l.Yb("ngModelChange",(function(t){return l.oc(e),l.ac().teamLocal=t}))("ionChange",(function(t){return l.oc(e),l.ac().selectLocal(t)})),l.Qb(4,"ion-select-option",22),l.vc(5),l.Pb(),l.Qb(6,"ion-select-option",23),l.vc(7),l.Pb(),l.Pb(),l.Qb(8,"div",10),l.vc(9),l.Pb(),l.Pb()}if(2&e){const e=l.ac();l.yb(3),l.gc("ngModel",e.teamLocal)("interfaceOptions",e.customActionSheetOptions),l.yb(2),l.wc(e.teamsSelect.v.name),l.yb(2),l.wc(e.teamsSelect.l.name),l.yb(2),l.wc(e.serviceGame.errorsForm.get("v_team"))}}function M(e,t){if(1&e&&l.Mb(0,"app-show-map",27),2&e){const e=l.ac(2);l.gc("field",e.game.field)}}function F(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-input",28),l.Yb("ngModelChange",(function(t){return l.oc(e),l.ac(2).game.location=t})),l.Pb()}if(2&e){const e=l.ac(2);l.gc("ngModel",e.game.location)}}function k(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",24),l.Qb(1,"ion-button",6),l.Yb("click",(function(){return l.oc(e),l.ac().selectField()})),l.vc(2),l.Pb(),l.uc(3,M,1,1,"app-show-map",25),l.uc(4,F,1,1,"ion-input",26),l.Pb()}if(2&e){const e=l.ac();l.yb(2),l.xc("",e.game.field?"Modificar":"A\xf1adir"," ubicaci\xf3n"),l.yb(1),l.gc("ngIf",e.game.field),l.yb(1),l.gc("ngIf",!1)}}let S=(()=>{class e{constructor(e,t,i,o,s,a,c,l,r){var d;this.request=e,this.dialogService=t,this.viewCtrl=i,this.photoService=o,this.authUser=a,this.util=c,this.chatService=l,this.transfData=r,this.myTeams=[],this.teams=[],this.teamsSelect={v:"",l:""},this.numbGoals=[],this.customDayShortNames=["s\xf8n"],this.status=["Pendiente","Suspendido","Jugado","Created"],this.customActionSheetOptions={header:"Equipo Local"},this.myDateFilter=e=>6==e.getDay(),this.serviceGame=new n.a("Game",e),this.serviceTeam=new n.a("Team",e),this.id=s.get("id"),this.toDate=null!==(d=s.get("date"))&&void 0!==d?d:c.setFormatMoment(new Date,"YYYY-MM-DD"),console.log("date",this.toDate),this.test()}test(){console.log("day default :",a().isoWeekday()),console.log("day 4 :",a().isoWeekday(6))}ngOnInit(){this.myTeams=this.authUser.user.teams,this.teamsSelect.v=this.myTeams[0],this.serviceTeam.api_function("getAllTeamsSelect").subscribe(e=>{e.data&&(this.teams=e.data,console.log("teams -> ",this.teams),this.teams.push({id:-1,name:"Equipo nuevo"}),console.log("add Otro"))});for(var e=0;e<=30;e++)this.numbGoals.push(e);this.initObject()}initObject(){this.game={l_team:"",v_team:"",l_goals:0,v_goals:0,time:"15:00",date:this.toDate,location:"",description:"",status:"Pendiente",field:null,field_id:""},this.id&&this.serviceGame.api_find(this.id).subscribe(e=>{"success"==e.status&&(this.game=e.Game)})}submit(){return Object(o.b)(this,void 0,void 0,(function*(){this.game.date=this.util.setFormatMoment(this.game.date,"YYYY-MM-DD");try{this.valid()}catch(e){return void this.dialogService.showToast(e.message,"Error","danger")}yield this.dialogService.loadingProgres(),this.game.team_creator=this.teamsSelect.v.id,this.serviceGame.api_function("createGameAdmin",this.game).subscribe(e=>{"success"==e.status?(this.dialogService.showToast("Partido registrado"),this.dismiss(e.data)):"error"==e.status&&this.dialogService.showToast(e.errorValidaciones?e.errorValidaciones:e.mensaje,"","danger",5e3),this.dialogService.dimissLoaging()},e=>{console.log(e),this.dialogService.dimissLoaging(),this.dialogService.showToast(e.error.mensaje,"","danger",7e3)},()=>{this.dialogService.dimissLoaging()})}))}dismiss(e){this.chatService.hide(),this.viewCtrl.dismiss({game:e})}close(){this.chatService.hide(),this.viewCtrl.dismiss()}print(){console.log(this.game)}selectLocal(e){let t=e.detail.value;this.game.l_team=this.teamsSelect[t].id,this.game.v_team=this.teamsSelect["v"==t?"l":"v"].id,this.teamsSelect[t]&&this.setField(this.teamsSelect[t].field),console.log(this.game)}clearLocal(){this.teamLocal=null,this.game.l_team="",this.game.v_team=""}valid(){if(console.log("valid Game"),!this.teamsSelect.l)throw new Error("No ha seleccionado el equipo contrario");if(this.teamsSelect.v.id==this.teamsSelect.l.id)throw new Error("Los equipos enfrentados deben ser diferentes");if(-1==this.teamsSelect.l.id&&!this.game.other_team)throw new Error("Debes a\xf1adir el nombre del Equipo Nuevo.");if(!this.teamLocal)throw new Error("Debe seleccionar el equipo local");if(!this.game.date)throw new Error("Debe seleccionar la fecha.");if(6!=a(this.game.date).isoWeekday())throw new Error("La fecha seleccionada debe ser un S\xc1BADO.")}selectTeam(e,t){return Object(o.b)(this,void 0,void 0,(function*(){this.transfData.setData("teams",e);const i=yield this.viewCtrl.create({component:s.a});i.onDidDismiss().then(e=>{const i=e.data.team;i&&(this.teamsSelect[t]=i,this.clearLocal())}),yield i.present()}))}selectField(){return Object(o.b)(this,void 0,void 0,(function*(){const e=yield this.viewCtrl.create({component:c.a});e.onDidDismiss().then(e=>{console.log("close modal select field"),e.data&&e.data.field&&this.setField(e.data.field)}),yield e.present()}))}setField(e){e?(this.game.field=e,this.game.field_id=e.id):(this.game.field=null,this.game.field_id=null)}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(r.a),l.Lb(d.a),l.Lb(b.nb),l.Lb(h.a),l.Lb(b.pb),l.Lb(m.a),l.Lb(u.a),l.Lb(g.a),l.Lb(f.a))},e.\u0275cmp=l.Fb({type:e,selectors:[["app-create-game-admin"]],decls:48,vars:12,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["slot","secondary"],[3,"color","click",4,"ngIf"],[3,"ngSubmit","keyup"],[3,"click"],["position","stacked"],["type","text","readonly",""],["name","chevron-forward-outline",1,"fle"],[2,"color","red","padding-top","0.2rem"],["type","text","readonly","",3,"click"],[4,"ngIf"],["class","ion-text-center",4,"ngIf"],["displayFormat","HH:mm ","name","time",3,"ngModel","ngModelChange"],["name","date","displayFormat","DD-MM-YYYY",3,"ngModel","ngModelChange"],["type","submit","expand","block"],[3,"color","click"],["name","help-circle-outline"],["position","floating"],["type","text","name","other_team",3,"ngModel","ngModelChange"],["name","v_team","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],["value","v"],["value","l"],[1,"ion-text-center"],[3,"field",4,"ngIf"],["type","text","name","location",3,"ngModel","ngModelChange",4,"ngIf"],[3,"field"],["type","text","name","location",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(l.Qb(0,"ion-header"),l.Qb(1,"ion-toolbar"),l.Qb(2,"ion-title"),l.vc(3,"Nuevo Partido"),l.Pb(),l.Qb(4,"ion-buttons",0),l.Qb(5,"ion-button",1),l.Yb("click",(function(){return t.close()})),l.Mb(6,"ion-icon",2),l.Pb(),l.Pb(),l.Qb(7,"ion-buttons",3),l.uc(8,y,2,1,"ion-button",4),l.Pb(),l.Pb(),l.Pb(),l.Qb(9,"ion-content"),l.Qb(10,"form",5),l.Yb("ngSubmit",(function(){return t.submit()}))("keyup",(function(){return t.serviceGame.errorsForm.clear()})),l.Qb(11,"ion-item",6),l.Yb("click",(function(){return t.selectTeam(t.myTeams,"v")})),l.Qb(12,"ion-label",7),l.vc(13,"Mi Equipo"),l.Pb(),l.Qb(14,"ion-input",8),l.vc(15),l.Pb(),l.Mb(16,"ion-icon",9),l.Qb(17,"div",10),l.vc(18),l.Pb(),l.Pb(),l.Qb(19,"ion-item"),l.Qb(20,"ion-label",7),l.vc(21,"Contrario"),l.Pb(),l.Qb(22,"ion-input",11),l.Yb("click",(function(){return t.selectTeam(t.teams,"l")})),l.vc(23),l.Pb(),l.Mb(24,"ion-icon",9),l.Qb(25,"div",10),l.vc(26),l.Pb(),l.Pb(),l.Mb(27,"br"),l.uc(28,w,4,1,"ion-item",12),l.Qb(29,"div",10),l.vc(30),l.Pb(),l.Mb(31,"br"),l.uc(32,Q,10,5,"ion-item",12),l.Mb(33,"br"),l.uc(34,k,5,3,"div",13),l.Qb(35,"div",10),l.vc(36),l.Pb(),l.Mb(37,"br"),l.Qb(38,"ion-item"),l.Qb(39,"ion-label"),l.vc(40,"HH:mm"),l.Pb(),l.Qb(41,"ion-datetime",14),l.Yb("ngModelChange",(function(e){return t.game.time=e})),l.Pb(),l.Pb(),l.Qb(42,"ion-item"),l.Qb(43,"ion-label"),l.vc(44,"Fecha"),l.Pb(),l.Qb(45,"ion-datetime",15),l.Yb("ngModelChange",(function(e){return t.game.date=e})),l.Pb(),l.Pb(),l.Qb(46,"ion-button",16),l.vc(47,"Guardar"),l.Pb(),l.Pb(),l.Pb()),2&e&&(l.yb(8),l.gc("ngIf",t.chatService.isInit),l.yb(7),l.wc(t.teamsSelect.v?t.teamsSelect.v.name:""),l.yb(3),l.wc(t.serviceGame.errorsForm.get("l_team")),l.yb(5),l.wc(t.teamsSelect.l?t.teamsSelect.l.name:""),l.yb(3),l.wc(t.serviceGame.errorsForm.get("v_team")),l.yb(2),l.gc("ngIf",t.teamsSelect.l&&-1==t.teamsSelect.l.id),l.yb(2),l.wc(t.serviceGame.errorsForm.get("other_team")),l.yb(2),l.gc("ngIf",t.teamsSelect.v&&t.teamsSelect.l),l.yb(2),l.gc("ngIf",t.teamLocal),l.yb(2),l.wc(t.serviceGame.errorsForm.get("location")),l.yb(5),l.gc("ngModel",t.game.time),l.yb(4),l.gc("ngModel",t.game.date))},directives:[b.x,b.jb,b.hb,b.j,b.i,b.y,p.l,b.r,v.i,v.e,v.f,b.D,b.G,b.C,b.vb,b.s,b.ub,v.d,v.g,b.W,b.X,P.a],styles:[".fle[_ngcontent-%COMP%]{position:absolute;right:3px;top:45%}"]}),e})()}}]);