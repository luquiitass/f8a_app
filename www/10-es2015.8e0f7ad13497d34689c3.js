(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{XDjf:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("mrSG"),s=i("4R65"),n=i("8xVP"),a=i("qsXW"),c=i("fXoL"),l=i("G/jy"),r=i("Bfh1"),d=i("m/P+"),b=i("TEn/"),m=i("ofXK");function h(e,t){if(1&e){const e=c.Rb();c.Qb(0,"div",2),c.Qb(1,"ion-button",3),c.Yb("click",(function(){return c.oc(e),c.ac().shareW()})),c.Mb(2,"ion-icon",4),c.vc(3," Enviar ubicaci\xf3n "),c.Pb(),c.Qb(4,"ion-button",3),c.Yb("click",(function(){return c.oc(e),c.ac().getRoute()})),c.Mb(5,"ion-icon",5),c.vc(6," Como llegar "),c.Pb(),c.Pb()}}let u=(()=>{class e{constructor(e,t,i,o){this.request=e,this.geolocation=t,this.iab=i,this.modalController=o,this.showDirection=!1,this.newMarker=null,this.position={lat:0,lng:0},this.modelField=new n.a("Field",e)}ngOnInit(){return Object(o.b)(this,void 0,void 0,(function*(){this.loadField(),this.getLocation()}))}loadField(){console.log("load field"),this.id&&this.modelField.api_find(this.id).subscribe(e=>{"success"==e.status&&(this.field=e.Field,this.reset(),this.leafletMap(),this.refresh())})}getLocation(){return Object(o.b)(this,void 0,void 0,(function*(){console.log("get position"),yield this.geolocation.getCurrentPosition({timeout:6e3}).then(e=>{console.log("resp geo",e),this.position.lat=e.coords.latitude,this.position.lng=e.coords.longitude}).catch(e=>{console.error("error geo ",e)}),this.geolocation.watchPosition().subscribe(e=>{console.log("data geo",e)})}))}getRoute(){return Object(o.b)(this,void 0,void 0,(function*(){this.comoLlegar()}))}leafletMap(){this.map=s.map("mapId").setView([this.field.lat,this.field.lng],11),this.map.on("load",()=>{console.log("load map"),this.refresh()}),this.map.on("locationfound",e=>{console.log("loc found ",e)}),this.map.on("locationerror",e=>{console.log("loc error ",e)}),s.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"futbol8alem.com",id:"mapbox/streets-v11"}).addTo(this.map);var e=s.icon({iconUrl:"http://icons.iconseeker.com/png/fullsize/sport-fields/football-field.png",iconSize:[30,40],iconAnchor:[15,40],shadowSize:[35,50],shadowAnchor:[0,55],popupAnchor:[0,-40]});s.marker([this.field.lat,this.field.lng],{icon:e}).addTo(this.map).bindPopup(this.field.name,{permanent:!0}).openPopup(),this.refresh()}ngOnChanges(e){console.log("changes"),e.field&&setTimeout(()=>{this.map&&(this.map.off(),this.map.remove()),this.leafletMap()})}refresh(){setTimeout(()=>{this.map.invalidateSize()},1e3)}reset(){this.map&&(this.map.off(),this.map.remove())}ionViewDidLeave(){console.log("ionViewDidLeave component show-map"),this.reset()}comoLlegar(){this.iab.create(`https://www.google.com/maps/dir/?api=1&destination=${this.field.lat},${this.field.lng}`,"",{fullscreen:"yes"})}shareW(){let e=encodeURIComponent(`https://www.google.com/maps/dir/?api=1&destination=${this.field.lat},${this.field.lng}`);this.iab.create("https://api.whatsapp.com/send?text="+e,"",{fullscreen:"yes"})}show(e){return Object(o.b)(this,void 0,void 0,(function*(){console.log("show");const t=yield this.modalController.create({component:a.a,componentProps:{id:e.id}});return t.onDidDismiss().then(e=>{}),yield t.present()}))}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(l.a),c.Lb(r.a),c.Lb(d.a),c.Lb(b.nb))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-show-map"]],inputs:{field:"field",showDirection:"showDirection",id:"id"},features:[c.wb],decls:2,vars:4,consts:[["id","mapId",3,"click"],["class","ion-text-right",4,"ngIf"],[1,"ion-text-right"],[3,"click"],["name","logo-whatsapp"],["name","navigate-outline"]],template:function(e,t){1&e&&(c.Qb(0,"div",0),c.Yb("click",(function(){return t.show(t.field)})),c.Pb(),c.uc(1,h,7,0,"div",1)),2&e&&(c.sc("width: 100%; height: ",t.field?"300":"0","px;"),c.yb(1),c.gc("ngIf",t.showDirection&&t.field))},directives:[m.l,b.i,b.y],styles:[""]}),e})()},qq2r:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var o=i("9suA"),s=i("fXoL"),n=i("TEn/"),a=i("ofXK"),c=i("EbHZ");function l(e,t){1&e&&(s.Qb(0,"ion-list-header",6),s.Qb(1,"ion-label"),s.vc(2,"No se ha encontrado equipos"),s.Pb(),s.Pb())}function r(e,t){if(1&e&&(s.Qb(0,"ion-avatar",0),s.Mb(1,"ion-img",11),s.Pb()),2&e){const e=s.ac().$implicit;s.yb(1),s.gc("src",e.shield?e.shield.urlCompleteThumb:"assets/images/esc.png")}}function d(e,t){if(1&e){const e=s.Rb();s.Qb(0,"ion-item",7),s.Yb("click",(function(){s.oc(e);const i=t.$implicit;return s.ac().dismiss(i)})),s.uc(1,r,2,1,"ion-avatar",8),s.Qb(2,"ion-label"),s.Qb(3,"h3",9),s.vc(4),s.Pb(),s.Pb(),s.Mb(5,"ion-icon",10),s.Pb()}if(2&e){const e=t.$implicit;s.yb(1),s.gc("ngIf",-1!=e.id),s.yb(3),s.wc(-1==e.id?"Registrar Nuevo Equipo ":e.name)}}let b=(()=>{class e extends o.a{constructor(e,t,i){super(t,e),this.viewCtrl=e,this.location=t,this.dataTranfer=i,this.teams=[],this.oldTeams=[],this.textSearch="",this.teams=i.getData("teams"),this.oldTeams=[...this.teams]}initObject(){}dismiss(e){this.viewCtrl.dismiss({team:e})}close(){this.viewCtrl.dismiss()}filterTeams(e){e.length<=0?this.teams=this.oldTeams:(this.teams=[...this.oldTeams],this.teams=this.teams.filter(t=>t.name.toUpperCase().includes(e.toUpperCase())||-1==t.id))}getFilter(){return this.teams.filter(e=>e.name.toUpperCase().includes(this.textSearch.toUpperCase())||-1==e.id)}cancelFilter(e){this.teams=this.oldTeams}filterChangue(e){this.textSearch=e.detail.value}log(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(n.nb),s.Lb(a.n),s.Lb(c.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-modal-filter"]],features:[s.vb],decls:12,vars:2,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["placeholder","Filtrar equipos",3,"ionClear","ionChange"],["color","tertiary",4,"ngIf"],["class","team-list",3,"click",4,"ngFor","ngForOf"],["color","tertiary"],[1,"team-list",3,"click"],["slot","start",4,"ngIf"],[1,"fs-team"],["name","chevron-forward-outline"],[3,"src"]],template:function(e,t){1&e&&(s.Qb(0,"ion-header"),s.Qb(1,"ion-toolbar"),s.Qb(2,"ion-buttons",0),s.Qb(3,"ion-button",1),s.Yb("click",(function(){return t.close()})),s.Mb(4,"ion-icon",2),s.Pb(),s.Pb(),s.Qb(5,"ion-title"),s.vc(6,"Buscar Equipo"),s.Pb(),s.Pb(),s.Pb(),s.Qb(7,"ion-content"),s.Qb(8,"ion-searchbar",3),s.Yb("ionClear",(function(e){return t.cancelFilter(e)}))("ionChange",(function(e){return t.filterChangue(e)})),s.Pb(),s.Qb(9,"ion-list"),s.uc(10,l,3,0,"ion-list-header",4),s.uc(11,d,6,2,"ion-item",5),s.Pb(),s.Pb()),2&e&&(s.yb(10),s.gc("ngIf",0==t.getFilter().length),s.yb(1),s.gc("ngForOf",t.getFilter()))},directives:[n.x,n.jb,n.j,n.i,n.y,n.hb,n.r,n.T,n.vb,n.H,a.l,a.k,n.I,n.G,n.D,n.e,n.z],styles:[""]}),e})()},z0x6:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));var o=i("mrSG"),s=i("8xVP"),n=i("qq2r"),a=i("wd/R"),c=i("fSJy"),l=i("fXoL"),r=i("G/jy"),d=i("vuFD"),b=i("TEn/"),m=i("6/gD"),h=i("y/q6"),u=i("2Rin"),g=i("sjK5"),f=i("EbHZ"),p=i("ofXK"),v=i("3Pt+"),y=i("XDjf");function w(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-button",17),l.Yb("click",(function(){return l.oc(e),l.ac().chatService.toggle()})),l.Mb(1,"ion-icon",18),l.Pb()}if(2&e){const e=l.ac();l.gc("color",e.chatService.isVisible?"success":"")}}function P(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item"),l.Qb(1,"ion-label",19),l.vc(2,"Nombre de equipo nuevo"),l.Pb(),l.Qb(3,"ion-input",20),l.Yb("ngModelChange",(function(t){return l.oc(e),l.ac().game.other_team=t})),l.Pb(),l.Pb()}if(2&e){const e=l.ac();l.yb(3),l.gc("ngModel",e.game.other_team)}}function Q(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item"),l.Qb(1,"ion-label",19),l.vc(2,"Equipo Local"),l.Pb(),l.Qb(3,"ion-select",21),l.Yb("ngModelChange",(function(t){return l.oc(e),l.ac().teamLocal=t}))("ionChange",(function(t){return l.oc(e),l.ac().selectLocal(t)})),l.Qb(4,"ion-select-option",22),l.vc(5),l.Pb(),l.Qb(6,"ion-select-option",23),l.vc(7),l.Pb(),l.Pb(),l.Qb(8,"div",10),l.vc(9),l.Pb(),l.Pb()}if(2&e){const e=l.ac();l.yb(3),l.gc("ngModel",e.teamLocal)("interfaceOptions",e.customActionSheetOptions),l.yb(2),l.wc(e.teamsSelect.v.name),l.yb(2),l.wc(e.teamsSelect.l.name),l.yb(2),l.wc(e.serviceGame.errorsForm.get("v_team"))}}function S(e,t){if(1&e&&l.Mb(0,"app-show-map",27),2&e){const e=l.ac(2);l.gc("field",e.game.field)}}function M(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-input",28),l.Yb("ngModelChange",(function(t){return l.oc(e),l.ac(2).game.location=t})),l.Pb()}if(2&e){const e=l.ac(2);l.gc("ngModel",e.game.location)}}function C(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",24),l.Qb(1,"ion-button",6),l.Yb("click",(function(){return l.oc(e),l.ac().selectField()})),l.vc(2),l.Pb(),l.uc(3,S,1,1,"app-show-map",25),l.uc(4,M,1,1,"ion-input",26),l.Pb()}if(2&e){const e=l.ac();l.yb(2),l.xc("",e.game.field?"Modificar":"A\xf1adir"," ubicaci\xf3n"),l.yb(1),l.gc("ngIf",e.game.field),l.yb(1),l.gc("ngIf",!1)}}let L=(()=>{class e{constructor(e,t,i,o,n,a,c,l,r){var d;this.request=e,this.dialogService=t,this.viewCtrl=i,this.photoService=o,this.authUser=a,this.util=c,this.chatService=l,this.transfData=r,this.myTeams=[],this.teams=[],this.teamsSelect={v:"",l:""},this.numbGoals=[],this.customDayShortNames=["s\xf8n"],this.status=["Pendiente","Suspendido","Jugado","Created"],this.customActionSheetOptions={header:"Equipo Local"},this.myDateFilter=e=>6==e.getDay(),this.serviceGame=new s.a("Game",e),this.serviceTeam=new s.a("Team",e),this.id=n.get("id"),this.toDate=null!==(d=n.get("date"))&&void 0!==d?d:c.setFormatMoment(new Date,"YYYY-MM-DD"),console.log("date",this.toDate),this.test()}test(){console.log("day default :",a().isoWeekday()),console.log("day 4 :",a().isoWeekday(6))}ngOnInit(){this.myTeams=this.authUser.user.teams,this.teamsSelect.v=this.myTeams[0],this.serviceTeam.api_function("getAllTeamsSelect").subscribe(e=>{e.data&&(this.teams=e.data,console.log("teams -> ",this.teams),this.teams.push({id:-1,name:"Equipo nuevo"}),console.log("add Otro"))});for(var e=0;e<=30;e++)this.numbGoals.push(e);this.initObject()}initObject(){this.game={l_team:"",v_team:"",l_goals:0,v_goals:0,time:"15:00",date:this.toDate,location:"",description:"",status:"Pendiente",field:null,field_id:""},this.id&&this.serviceGame.api_find(this.id).subscribe(e=>{"success"==e.status&&(this.game=e.Game)})}submit(){return Object(o.b)(this,void 0,void 0,(function*(){this.game.date=this.util.setFormatMoment(this.game.date,"YYYY-MM-DD");try{this.valid()}catch(e){return void this.dialogService.showToast(e.message,"Error","danger")}yield this.dialogService.loadingProgres(),this.game.team_creator=this.teamsSelect.v.id,this.serviceGame.api_function("createGameAdmin",this.game).subscribe(e=>{"success"==e.status?(this.dialogService.showToast("Partido registrado"),this.dismiss(e.data)):"error"==e.status&&this.dialogService.showToast(e.errorValidaciones?e.errorValidaciones:e.mensaje,"","danger",5e3),this.dialogService.dimissLoaging()},e=>{console.log(e),this.dialogService.dimissLoaging(),this.dialogService.showToast(e.error.mensaje,"","danger",7e3)},()=>{this.dialogService.dimissLoaging()})}))}dismiss(e){this.chatService.hide(),this.viewCtrl.dismiss({game:e})}close(){this.chatService.hide(),this.viewCtrl.dismiss()}print(){console.log(this.game)}selectLocal(e){let t=e.detail.value;this.game.l_team=this.teamsSelect[t].id,this.game.v_team=this.teamsSelect["v"==t?"l":"v"].id,this.teamsSelect[t]&&this.setField(this.teamsSelect[t].field),console.log(this.game)}clearLocal(){this.teamLocal=null,this.game.l_team="",this.game.v_team=""}valid(){if(console.log("valid Game"),!this.teamsSelect.l)throw new Error("No ha seleccionado el equipo contrario");if(this.teamsSelect.v.id==this.teamsSelect.l.id)throw new Error("Los equipos enfrentados deben ser diferentes");if(-1==this.teamsSelect.l.id&&!this.game.other_team)throw new Error("Debes a\xf1adir el nombre del Equipo Nuevo.");if(!this.teamLocal)throw new Error("Debe seleccionar el equipo local");if(!this.game.date)throw new Error("Debe seleccionar la fecha.");a(this.game.date).isoWeekday()}selectTeam(e,t){return Object(o.b)(this,void 0,void 0,(function*(){this.transfData.setData("teams",e);const i=yield this.viewCtrl.create({component:n.a});i.onDidDismiss().then(e=>{const i=e.data.team;i&&(this.teamsSelect[t]=i,this.clearLocal())}),yield i.present()}))}selectField(){return Object(o.b)(this,void 0,void 0,(function*(){this.transfData.setData("isSelect",!0);const e=yield this.viewCtrl.create({component:c.a});e.onDidDismiss().then(e=>{console.log("close modal select field"),e.data&&e.data.field&&this.setField(e.data.field)}),yield e.present()}))}setField(e){e?(this.game.field=e,this.game.field_id=e.id):(this.game.field=null,this.game.field_id=null)}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(r.a),l.Lb(d.a),l.Lb(b.nb),l.Lb(m.a),l.Lb(b.pb),l.Lb(h.a),l.Lb(u.a),l.Lb(g.a),l.Lb(f.a))},e.\u0275cmp=l.Fb({type:e,selectors:[["app-create-game-admin"]],decls:48,vars:12,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["slot","secondary"],[3,"color","click",4,"ngIf"],[3,"ngSubmit","keyup"],[3,"click"],["position","stacked"],["type","text","readonly",""],["name","chevron-forward-outline",1,"fle"],[2,"color","red","padding-top","0.2rem"],["type","text","readonly","",3,"click"],[4,"ngIf"],["class","ion-text-center",4,"ngIf"],["displayFormat","HH:mm ","name","time",3,"ngModel","ngModelChange"],["name","date","displayFormat","DD-MM-YYYY",3,"ngModel","ngModelChange"],["type","submit","expand","block"],[3,"color","click"],["name","help-circle-outline"],["position","floating"],["type","text","name","other_team",3,"ngModel","ngModelChange"],["name","v_team","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],["value","v"],["value","l"],[1,"ion-text-center"],[3,"field",4,"ngIf"],["type","text","name","location",3,"ngModel","ngModelChange",4,"ngIf"],[3,"field"],["type","text","name","location",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(l.Qb(0,"ion-header"),l.Qb(1,"ion-toolbar"),l.Qb(2,"ion-title"),l.vc(3,"Nuevo Partido"),l.Pb(),l.Qb(4,"ion-buttons",0),l.Qb(5,"ion-button",1),l.Yb("click",(function(){return t.close()})),l.Mb(6,"ion-icon",2),l.Pb(),l.Pb(),l.Qb(7,"ion-buttons",3),l.uc(8,w,2,1,"ion-button",4),l.Pb(),l.Pb(),l.Pb(),l.Qb(9,"ion-content"),l.Qb(10,"form",5),l.Yb("ngSubmit",(function(){return t.submit()}))("keyup",(function(){return t.serviceGame.errorsForm.clear()})),l.Qb(11,"ion-item",6),l.Yb("click",(function(){return t.selectTeam(t.myTeams,"v")})),l.Qb(12,"ion-label",7),l.vc(13,"Mi Equipo"),l.Pb(),l.Qb(14,"ion-input",8),l.vc(15),l.Pb(),l.Mb(16,"ion-icon",9),l.Qb(17,"div",10),l.vc(18),l.Pb(),l.Pb(),l.Qb(19,"ion-item"),l.Qb(20,"ion-label",7),l.vc(21,"Contrario"),l.Pb(),l.Qb(22,"ion-input",11),l.Yb("click",(function(){return t.selectTeam(t.teams,"l")})),l.vc(23),l.Pb(),l.Mb(24,"ion-icon",9),l.Qb(25,"div",10),l.vc(26),l.Pb(),l.Pb(),l.Mb(27,"br"),l.uc(28,P,4,1,"ion-item",12),l.Qb(29,"div",10),l.vc(30),l.Pb(),l.Mb(31,"br"),l.uc(32,Q,10,5,"ion-item",12),l.Mb(33,"br"),l.uc(34,C,5,3,"div",13),l.Qb(35,"div",10),l.vc(36),l.Pb(),l.Mb(37,"br"),l.Qb(38,"ion-item"),l.Qb(39,"ion-label"),l.vc(40,"HH:mm"),l.Pb(),l.Qb(41,"ion-datetime",14),l.Yb("ngModelChange",(function(e){return t.game.time=e})),l.Pb(),l.Pb(),l.Qb(42,"ion-item"),l.Qb(43,"ion-label"),l.vc(44,"Fecha"),l.Pb(),l.Qb(45,"ion-datetime",15),l.Yb("ngModelChange",(function(e){return t.game.date=e})),l.Pb(),l.Pb(),l.Qb(46,"ion-button",16),l.vc(47,"Guardar"),l.Pb(),l.Pb(),l.Pb()),2&e&&(l.yb(8),l.gc("ngIf",t.chatService.isInit),l.yb(7),l.wc(t.teamsSelect.v?t.teamsSelect.v.name:""),l.yb(3),l.wc(t.serviceGame.errorsForm.get("l_team")),l.yb(5),l.wc(t.teamsSelect.l?t.teamsSelect.l.name:""),l.yb(3),l.wc(t.serviceGame.errorsForm.get("v_team")),l.yb(2),l.gc("ngIf",t.teamsSelect.l&&-1==t.teamsSelect.l.id),l.yb(2),l.wc(t.serviceGame.errorsForm.get("other_team")),l.yb(2),l.gc("ngIf",t.teamsSelect.v&&t.teamsSelect.l),l.yb(2),l.gc("ngIf",t.teamLocal),l.yb(2),l.wc(t.serviceGame.errorsForm.get("location")),l.yb(5),l.gc("ngModel",t.game.time),l.yb(4),l.gc("ngModel",t.game.date))},directives:[b.x,b.jb,b.hb,b.j,b.i,b.y,p.l,b.r,v.i,v.e,v.f,b.D,b.G,b.C,b.vb,b.s,b.ub,v.d,v.g,b.W,b.X,y.a],styles:[".fle[_ngcontent-%COMP%]{position:absolute;right:3px;top:45%}"]}),e})()}}]);