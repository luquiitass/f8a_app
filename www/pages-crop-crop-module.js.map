{"version":3,"sources":["ng:/ngx-image-cropper/lib/interfaces/move-start.interface.ts","ng:/ngx-image-cropper/lib/utils/resize.utils.ts","ng:/ngx-image-cropper/lib/services/crop.service.ts","ng:/ngx-image-cropper/lib/interfaces/cropper.settings.ts","ng:/ngx-image-cropper/lib/utils/exif.utils.ts","ng:/ngx-image-cropper/lib/services/load-image.service.ts","ng:/ngx-image-cropper/lib/services/cropper-position.service.ts","ng:/ngx-image-cropper/lib/utils/keyboard.utils.ts","ng:/ngx-image-cropper/lib/component/image-cropper.component.ts","ng:/ngx-image-cropper/lib/image-cropper.module.ts","ng:/ngx-image-cropper/lib/utils/blob.utils.ts","./src/app/pages/crop/crop-routing.module.ts","./src/app/pages/crop/crop.module.ts"],"names":[],"mappings":"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","file":"pages-crop-crop-module.js","sourcesContent":["export interface MoveStart {\n  active: boolean;\n  type: MoveTypes | null;\n  position: string | null;\n  x1: number;\n  y1: number;\n  x2: number;\n  y2: number;\n  clientX: number;\n  clientY: number;\n}\n\nexport enum MoveTypes {\n  Move = 'move',\n  Resize = 'resize',\n  Pinch = 'pinch'\n}\n","/*\n * Hermite resize - fast image resize/resample using Hermite filter.\n * https://github.com/viliusle/Hermite-resize\n */\n\nexport function resizeCanvas(canvas: HTMLCanvasElement, width: number, height: number) {\n  const width_source = canvas.width;\n  const height_source = canvas.height;\n  width = Math.round(width);\n  height = Math.round(height);\n\n  const ratio_w = width_source / width;\n  const ratio_h = height_source / height;\n  const ratio_w_half = Math.ceil(ratio_w / 2);\n  const ratio_h_half = Math.ceil(ratio_h / 2);\n\n  const ctx = canvas.getContext('2d');\n  if (ctx) {\n    const img = ctx.getImageData(0, 0, width_source, height_source);\n    const img2 = ctx.createImageData(width, height);\n    const data = img.data;\n    const data2 = img2.data;\n\n    for (let j = 0; j < height; j++) {\n      for (let i = 0; i < width; i++) {\n        const x2 = (i + j * width) * 4;\n        const center_y = j * ratio_h;\n        let weight = 0;\n        let weights = 0;\n        let weights_alpha = 0;\n        let gx_r = 0;\n        let gx_g = 0;\n        let gx_b = 0;\n        let gx_a = 0;\n\n        const xx_start = Math.floor(i * ratio_w);\n        const yy_start = Math.floor(j * ratio_h);\n        let xx_stop = Math.ceil((i + 1) * ratio_w);\n        let yy_stop = Math.ceil((j + 1) * ratio_h);\n        xx_stop = Math.min(xx_stop, width_source);\n        yy_stop = Math.min(yy_stop, height_source);\n\n        for (let yy = yy_start; yy < yy_stop; yy++) {\n          const dy = Math.abs(center_y - yy) / ratio_h_half;\n          const center_x = i * ratio_w;\n          const w0 = dy * dy; //pre-calc part of w\n          for (let xx = xx_start; xx < xx_stop; xx++) {\n            const dx = Math.abs(center_x - xx) / ratio_w_half;\n            const w = Math.sqrt(w0 + dx * dx);\n            if (w >= 1) {\n              //pixel too far\n              continue;\n            }\n            //hermite filter\n            weight = 2 * w * w * w - 3 * w * w + 1;\n            const pos_x = 4 * (xx + yy * width_source);\n            //alpha\n            gx_a += weight * data[pos_x + 3];\n            weights_alpha += weight;\n            //colors\n            if (data[pos_x + 3] < 255)\n              weight = weight * data[pos_x + 3] / 250;\n            gx_r += weight * data[pos_x];\n            gx_g += weight * data[pos_x + 1];\n            gx_b += weight * data[pos_x + 2];\n            weights += weight;\n          }\n        }\n        data2[x2] = gx_r / weights;\n        data2[x2 + 1] = gx_g / weights;\n        data2[x2 + 2] = gx_b / weights;\n        data2[x2 + 3] = gx_a / weights_alpha;\n      }\n    }\n\n\n    canvas.width = width;\n    canvas.height = height;\n\n    //draw\n    ctx.putImageData(img2, 0, 0);\n  }\n}\n","import { ElementRef, Injectable } from '@angular/core';\nimport { CropperSettings } from '../interfaces/cropper.settings';\nimport { CropperPosition, ImageCroppedEvent, LoadedImage } from '../interfaces';\nimport { resizeCanvas } from '../utils/resize.utils';\n\n@Injectable({providedIn: 'root'})\nexport class CropService {\n\n  crop(sourceImage: ElementRef, loadedImage: LoadedImage, cropper: CropperPosition, settings: CropperSettings): ImageCroppedEvent | null {\n    const imagePosition = this.getImagePosition(sourceImage, loadedImage, cropper, settings);\n    const width = imagePosition.x2 - imagePosition.x1;\n    const height = imagePosition.y2 - imagePosition.y1;\n    const cropCanvas = document.createElement('canvas') as HTMLCanvasElement;\n    cropCanvas.width = width;\n    cropCanvas.height = height;\n\n    const ctx = cropCanvas.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n    if (settings.backgroundColor != null) {\n      ctx.fillStyle = settings.backgroundColor;\n      ctx.fillRect(0, 0, width, height);\n    }\n\n    const scaleX = (settings.transform.scale || 1) * (settings.transform.flipH ? -1 : 1);\n    const scaleY = (settings.transform.scale || 1) * (settings.transform.flipV ? -1 : 1);\n\n    const transformedImage = loadedImage.transformed;\n    ctx.setTransform(scaleX, 0, 0, scaleY, transformedImage.size.width / 2, transformedImage.size.height / 2);\n    ctx.translate(-imagePosition.x1 / scaleX, -imagePosition.y1 / scaleY);\n    ctx.rotate((settings.transform.rotate || 0) * Math.PI / 180);\n    ctx.drawImage(transformedImage.image, -transformedImage.size.width / 2, -transformedImage.size.height / 2);\n\n    const output: ImageCroppedEvent = {\n      width, height,\n      imagePosition,\n      cropperPosition: {...cropper}\n    };\n    if (settings.containWithinAspectRatio) {\n      output.offsetImagePosition = this.getOffsetImagePosition(sourceImage, loadedImage, cropper, settings);\n    }\n    const resizeRatio = this.getResizeRatio(width, height, settings);\n    if (resizeRatio !== 1) {\n      output.width = Math.round(width * resizeRatio);\n      output.height = settings.maintainAspectRatio\n        ? Math.round(output.width / settings.aspectRatio)\n        : Math.round(height * resizeRatio);\n      resizeCanvas(cropCanvas, output.width, output.height);\n    }\n    output.base64 = cropCanvas.toDataURL('image/' + settings.format, this.getQuality(settings));\n    return output;\n  }\n\n  private getImagePosition(sourceImage: ElementRef, loadedImage: LoadedImage, cropper: CropperPosition, settings: CropperSettings): CropperPosition {\n    const sourceImageElement = sourceImage.nativeElement;\n    const ratio = loadedImage.transformed.size.width / sourceImageElement.offsetWidth;\n\n    const out: CropperPosition = {\n      x1: Math.round(cropper.x1 * ratio),\n      y1: Math.round(cropper.y1 * ratio),\n      x2: Math.round(cropper.x2 * ratio),\n      y2: Math.round(cropper.y2 * ratio)\n    };\n\n    if (!settings.containWithinAspectRatio) {\n      out.x1 = Math.max(out.x1, 0);\n      out.y1 = Math.max(out.y1, 0);\n      out.x2 = Math.min(out.x2, loadedImage.transformed.size.width);\n      out.y2 = Math.min(out.y2, loadedImage.transformed.size.height);\n    }\n\n    return out;\n  }\n\n  private getOffsetImagePosition(sourceImage: ElementRef, loadedImage: LoadedImage, cropper: CropperPosition, settings: CropperSettings): CropperPosition {\n    const canvasRotation = settings.canvasRotation + loadedImage.exifTransform.rotate;\n    const sourceImageElement = sourceImage.nativeElement;\n    const ratio = loadedImage.transformed.size.width / sourceImageElement.offsetWidth;\n    let offsetX: number;\n    let offsetY: number;\n\n    if (canvasRotation % 2) {\n      offsetX = (loadedImage.transformed.size.width - loadedImage.original.size.height) / 2;\n      offsetY = (loadedImage.transformed.size.height - loadedImage.original.size.width) / 2;\n    } else {\n      offsetX = (loadedImage.transformed.size.width - loadedImage.original.size.width) / 2;\n      offsetY = (loadedImage.transformed.size.height - loadedImage.original.size.height) / 2;\n    }\n\n    const out: CropperPosition = {\n      x1: Math.round(cropper.x1 * ratio) - offsetX,\n      y1: Math.round(cropper.y1 * ratio) - offsetY,\n      x2: Math.round(cropper.x2 * ratio) - offsetX,\n      y2: Math.round(cropper.y2 * ratio) - offsetY\n    };\n\n    if (!settings.containWithinAspectRatio) {\n      out.x1 = Math.max(out.x1, 0);\n      out.y1 = Math.max(out.y1, 0);\n      out.x2 = Math.min(out.x2, loadedImage.transformed.size.width);\n      out.y2 = Math.min(out.y2, loadedImage.transformed.size.height);\n    }\n\n    return out;\n  }\n\n  getResizeRatio(width: number, height: number, settings: CropperSettings): number {\n    const ratioWidth = settings.resizeToWidth / width;\n    const ratioHeight = settings.resizeToHeight / height;\n    const ratios = new Array<number>();\n\n    if (settings.resizeToWidth > 0) {\n      ratios.push(ratioWidth);\n    }\n    if (settings.resizeToHeight > 0) {\n      ratios.push(ratioHeight);\n    }\n\n    const result = ratios.length === 0 ? 1 : Math.min(...ratios);\n\n    if (result > 1 && !settings.onlyScaleDown) {\n      return result;\n    }\n    return Math.min(result, 1);\n  }\n\n  getQuality(settings: CropperSettings): number {\n    return Math.min(1, Math.max(0, settings.imageQuality / 100));\n  }\n}\n","import { CropperOptions, OutputFormat } from './cropper-options.interface';\nimport { ImageTransform } from './image-transform.interface';\nimport { SimpleChanges } from '@angular/core';\n\nexport class CropperSettings {\n\n  // From options\n  format: OutputFormat = 'png';\n  maintainAspectRatio = true;\n  transform: ImageTransform = {};\n  aspectRatio = 1;\n  resizeToWidth = 0;\n  resizeToHeight = 0;\n  cropperMinWidth = 0;\n  cropperMinHeight = 0;\n  cropperMaxHeight = 0;\n  cropperMaxWidth = 0;\n  cropperStaticWidth = 0;\n  cropperStaticHeight = 0;\n  canvasRotation = 0;\n  initialStepSize = 3;\n  roundCropper = false;\n  onlyScaleDown = false;\n  imageQuality = 92;\n  autoCrop = true;\n  backgroundColor: string = undefined;\n  containWithinAspectRatio = false;\n  hideResizeSquares = false;\n  alignImage: 'left' | 'center' = 'center';\n\n  // Internal\n  cropperScaledMinWidth = 20;\n  cropperScaledMinHeight = 20;\n  cropperScaledMaxWidth = 20;\n  cropperScaledMaxHeight = 20;\n  stepSize = this.initialStepSize;\n\n  setOptions(options: Partial<CropperOptions>): void {\n    Object.keys(options)\n      .filter((k) => k in this)\n      .forEach((k) => this[k] = options[k]);\n  }\n\n  setOptionsFromChanges(changes: SimpleChanges): void {\n    Object.keys(changes)\n      .filter((k) => k in this)\n      .forEach((k) => this[k] = changes[k].currentValue);\n  }\n}\n","import { ExifTransform } from '../interfaces/exif-transform.interface';\n\n// Black 2x1 JPEG, with the following meta information set:\n// - EXIF Orientation: 6 (Rotated 90 CCW)\n// Source: https://github.com/blueimp/JavaScript-Load-Image\nconst testAutoOrientationImageURL =\n  'data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA' +\n  'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA' +\n  'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE' +\n  'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/x' +\n  'ABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAA' +\n  'AAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==';\n\nexport function supportsAutomaticRotation(): Promise<boolean> {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.onload = () => {\n      // Check if browser supports automatic image orientation:\n      const supported = img.width === 1 && img.height === 2;\n      resolve(supported);\n    };\n    img.src = testAutoOrientationImageURL;\n  });\n}\n\nexport function getTransformationsFromExifData(exifRotationOrBase64Image: number | string): ExifTransform {\n  if (typeof exifRotationOrBase64Image === 'string') {\n    exifRotationOrBase64Image = getExifRotation(exifRotationOrBase64Image);\n  }\n  switch (exifRotationOrBase64Image) {\n    case 2:\n      return {rotate: 0, flip: true};\n    case 3:\n      return {rotate: 2, flip: false};\n    case 4:\n      return {rotate: 2, flip: true};\n    case 5:\n      return {rotate: 1, flip: true};\n    case 6:\n      return {rotate: 1, flip: false};\n    case 7:\n      return {rotate: 3, flip: true};\n    case 8:\n      return {rotate: 3, flip: false};\n    default:\n      return {rotate: 0, flip: false};\n  }\n}\n\nfunction getExifRotation(imageBase64: string): number {\n  const view = new DataView(base64ToArrayBuffer(imageBase64));\n  if (view.getUint16(0, false) != 0xFFD8) {\n    return -2;\n  }\n  const length = view.byteLength;\n  let offset = 2;\n  while (offset < length) {\n    if (view.getUint16(offset + 2, false) <= 8) return -1;\n    const marker = view.getUint16(offset, false);\n    offset += 2;\n    if (marker == 0xFFE1) {\n      if (view.getUint32(offset += 2, false) != 0x45786966) {\n        return -1;\n      }\n\n      const little = view.getUint16(offset += 6, false) == 0x4949;\n      offset += view.getUint32(offset + 4, little);\n      const tags = view.getUint16(offset, little);\n      offset += 2;\n      for (let i = 0; i < tags; i++) {\n        if (view.getUint16(offset + (i * 12), little) == 0x0112) {\n          return view.getUint16(offset + (i * 12) + 8, little);\n        }\n      }\n    } else if ((marker & 0xFF00) != 0xFF00) {\n      break;\n    } else {\n      offset += view.getUint16(offset, false);\n    }\n  }\n  return -1;\n}\n\nfunction base64ToArrayBuffer(imageBase64: string) {\n  imageBase64 = imageBase64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n  const binaryString = atob(imageBase64);\n  const len = binaryString.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n","import { Injectable } from '@angular/core';\nimport { Dimensions, LoadedImage } from '../interfaces';\nimport { CropperSettings } from '../interfaces/cropper.settings';\nimport { ExifTransform } from '../interfaces/exif-transform.interface';\nimport { getTransformationsFromExifData, supportsAutomaticRotation } from '../utils/exif.utils';\n\ninterface LoadImageBase64 {\n  originalImage: HTMLImageElement;\n  originalBase64: string;\n}\n\n@Injectable({providedIn: 'root'})\nexport class LoadImageService {\n\n  private autoRotateSupported: Promise<boolean> = supportsAutomaticRotation();\n\n  loadImageFile(file: File, cropperSettings: CropperSettings): Promise<LoadedImage> {\n    return new Promise((resolve, reject) => {\n      const fileReader = new FileReader();\n      fileReader.onload = (event: any) => {\n        this.loadImage(event.target.result, file.type, cropperSettings)\n          .then(resolve)\n          .catch(reject);\n      };\n      fileReader.readAsDataURL(file);\n    });\n  }\n\n  private loadImage(imageBase64: string, imageType: string, cropperSettings: CropperSettings): Promise<LoadedImage> {\n    if (!this.isValidImageType(imageType)) {\n      return Promise.reject(new Error('Invalid image type'));\n    }\n    return this.loadBase64Image(imageBase64, cropperSettings);\n  }\n\n  private isValidImageType(type: string): boolean {\n    return /image\\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(type);\n  }\n\n  loadImageFromURL(url: string, cropperSettings: CropperSettings): Promise<LoadedImage> {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.onerror = () => reject;\n      img.onload = () => {\n        const canvas = document.createElement('canvas');\n        const context = canvas.getContext('2d');\n        canvas.width = img.width;\n        canvas.height = img.height;\n        context.drawImage(img, 0, 0);\n        this.loadBase64Image(canvas.toDataURL(), cropperSettings).then(resolve);\n      };\n      img.crossOrigin = 'anonymous';\n      img.src = url;\n    });\n  }\n\n  loadBase64Image(imageBase64: string, cropperSettings: CropperSettings): Promise<LoadedImage> {\n    return new Promise<LoadImageBase64>((resolve, reject) => {\n      const originalImage = new Image();\n      originalImage.onload = () => resolve({\n        originalImage,\n        originalBase64: imageBase64\n      });\n      originalImage.onerror = reject;\n      originalImage.src = imageBase64;\n    }).then((res: LoadImageBase64) => this.transformImageBase64(res, cropperSettings));\n  }\n\n  private async transformImageBase64(res: LoadImageBase64, cropperSettings: CropperSettings): Promise<LoadedImage> {\n    const autoRotate = await this.autoRotateSupported;\n    const exifTransform = await getTransformationsFromExifData(autoRotate ? -1 : res.originalBase64);\n    if (!res.originalImage || !res.originalImage.complete) {\n      return Promise.reject(new Error('No image loaded'));\n    }\n    const loadedImage = {\n      original: {\n        base64: res.originalBase64,\n        image: res.originalImage,\n        size: {\n          width: res.originalImage.naturalWidth,\n          height: res.originalImage.naturalHeight\n        }\n      },\n      exifTransform\n    };\n    return this.transformLoadedImage(loadedImage, cropperSettings);\n  }\n\n  async transformLoadedImage(loadedImage: Partial<LoadedImage>, cropperSettings: CropperSettings): Promise<LoadedImage> {\n    const canvasRotation = cropperSettings.canvasRotation + loadedImage.exifTransform.rotate;\n    const originalSize = {\n      width: loadedImage.original.image.naturalWidth,\n      height: loadedImage.original.image.naturalHeight\n    };\n    if (canvasRotation === 0 && !loadedImage.exifTransform.flip && !cropperSettings.containWithinAspectRatio) {\n      return {\n        original: {\n          base64: loadedImage.original.base64,\n          image: loadedImage.original.image,\n          size: {...originalSize}\n        },\n        transformed: {\n          base64: loadedImage.original.base64,\n          image: loadedImage.original.image,\n          size: {...originalSize}\n        },\n        exifTransform: loadedImage.exifTransform\n      };\n    }\n\n    const transformedSize = this.getTransformedSize(originalSize, loadedImage.exifTransform, cropperSettings);\n    const canvas = document.createElement('canvas');\n    canvas.width = transformedSize.width;\n    canvas.height = transformedSize.height;\n    const ctx = canvas.getContext('2d');\n    ctx.setTransform(\n      loadedImage.exifTransform.flip ? -1 : 1,\n      0,\n      0,\n      1,\n      canvas.width / 2,\n      canvas.height / 2\n    );\n    ctx.rotate(Math.PI * (canvasRotation / 2));\n    ctx.drawImage(\n      loadedImage.original.image,\n      -originalSize.width / 2,\n      -originalSize.height / 2\n    );\n    const transformedBase64 = canvas.toDataURL();\n    const transformedImage = await this.loadImageFromBase64(transformedBase64);\n    return {\n      original: {\n        base64: loadedImage.original.base64,\n        image: loadedImage.original.image,\n        size: {...originalSize}\n      },\n      transformed: {\n        base64: transformedBase64,\n        image: transformedImage,\n        size: {\n          width: transformedImage.width,\n          height: transformedImage.height\n        }\n      },\n      exifTransform: loadedImage.exifTransform\n    };\n  }\n\n  private loadImageFromBase64(imageBase64: string): Promise<HTMLImageElement> {\n    return new Promise<HTMLImageElement>(((resolve, reject) => {\n      const image = new Image();\n      image.onload = () => resolve(image);\n      image.onerror = reject;\n      image.src = imageBase64;\n    }));\n  }\n\n  private getTransformedSize(\n    originalSize: { width: number, height: number },\n    exifTransform: ExifTransform,\n    cropperSettings: CropperSettings\n  ): Dimensions {\n    const canvasRotation = cropperSettings.canvasRotation + exifTransform.rotate;\n    if (cropperSettings.containWithinAspectRatio) {\n      if (canvasRotation % 2) {\n        const minWidthToContain = originalSize.width * cropperSettings.aspectRatio;\n        const minHeightToContain = originalSize.height / cropperSettings.aspectRatio;\n        return {\n          width: Math.max(originalSize.height, minWidthToContain),\n          height: Math.max(originalSize.width, minHeightToContain)\n        };\n      } else {\n        const minWidthToContain = originalSize.height * cropperSettings.aspectRatio;\n        const minHeightToContain = originalSize.width / cropperSettings.aspectRatio;\n        return {\n          width: Math.max(originalSize.width, minWidthToContain),\n          height: Math.max(originalSize.height, minHeightToContain)\n        };\n      }\n    }\n\n    if (canvasRotation % 2) {\n      return {\n        height: originalSize.width,\n        width: originalSize.height\n      };\n    }\n    return {\n      width: originalSize.width,\n      height: originalSize.height\n    };\n  }\n}\n","import { ElementRef, Injectable } from '@angular/core';\nimport { CropperPosition, Dimensions, MoveStart } from '../interfaces';\nimport { CropperSettings } from '../interfaces/cropper.settings';\n\n@Injectable({providedIn: 'root'})\nexport class CropperPositionService {\n\n  resetCropperPosition(sourceImage: ElementRef, cropperPosition: CropperPosition, settings: CropperSettings): void {\n    const sourceImageElement = sourceImage.nativeElement;\n    if (settings.cropperStaticHeight && settings.cropperStaticWidth) {\n      cropperPosition.x1 = 0;\n      cropperPosition.x2 = sourceImageElement.offsetWidth > settings.cropperStaticWidth ?\n        settings.cropperStaticWidth : sourceImageElement.offsetWidth;\n      cropperPosition.y1 = 0;\n      cropperPosition.y2 = sourceImageElement.offsetHeight > settings.cropperStaticHeight ?\n        settings.cropperStaticHeight : sourceImageElement.offsetHeight;\n    } else {\n      const cropperWidth = Math.min(settings.cropperScaledMaxWidth, sourceImageElement.offsetWidth);\n      const cropperHeight = Math.min(settings.cropperScaledMaxHeight, sourceImageElement.offsetHeight);\n      if (!settings.maintainAspectRatio) {\n        cropperPosition.x1 = 0;\n        cropperPosition.x2 = cropperWidth;\n        cropperPosition.y1 = 0;\n        cropperPosition.y2 = cropperHeight;\n      } else if (cropperWidth / settings.aspectRatio < cropperHeight) {\n        cropperPosition.x1 = 0;\n        cropperPosition.x2 = cropperWidth;\n        const cropperHeightWithAspectRatio = cropperWidth / settings.aspectRatio;\n        cropperPosition.y1 = (sourceImageElement.offsetHeight - cropperHeightWithAspectRatio) / 2;\n        cropperPosition.y2 = cropperPosition.y1 + cropperHeightWithAspectRatio;\n      } else {\n        cropperPosition.y1 = 0;\n        cropperPosition.y2 = cropperHeight;\n        const cropperWidthWithAspectRatio = cropperHeight * settings.aspectRatio;\n        cropperPosition.x1 = (sourceImageElement.offsetWidth - cropperWidthWithAspectRatio) / 2;\n        cropperPosition.x2 = cropperPosition.x1 + cropperWidthWithAspectRatio;\n      }\n    }\n  }\n\n  move(event: any, moveStart: MoveStart, cropperPosition: CropperPosition) {\n    const diffX = this.getClientX(event) - moveStart.clientX;\n    const diffY = this.getClientY(event) - moveStart.clientY;\n\n    cropperPosition.x1 = moveStart.x1 + diffX;\n    cropperPosition.y1 = moveStart.y1 + diffY;\n    cropperPosition.x2 = moveStart.x2 + diffX;\n    cropperPosition.y2 = moveStart.y2 + diffY;\n  }\n\n  resize(event: any, moveStart: MoveStart, cropperPosition: CropperPosition, maxSize: Dimensions, settings: CropperSettings): void {\n    const moveX = this.getClientX(event) - moveStart.clientX;\n    const moveY = this.getClientY(event) - moveStart.clientY;\n    switch (moveStart.position) {\n      case 'left':\n        cropperPosition.x1 = Math.min(Math.max(moveStart.x1 + moveX, cropperPosition.x2 - settings.cropperScaledMaxWidth),\n          cropperPosition.x2 - settings.cropperScaledMinWidth);\n        break;\n      case 'topleft':\n        cropperPosition.x1 = Math.min(Math.max(moveStart.x1 + moveX, cropperPosition.x2 - settings.cropperScaledMaxWidth),\n          cropperPosition.x2 - settings.cropperScaledMinWidth);\n        cropperPosition.y1 = Math.min(Math.max(moveStart.y1 + moveY, cropperPosition.y2 - settings.cropperScaledMaxHeight),\n          cropperPosition.y2 - settings.cropperScaledMinHeight);\n        break;\n      case 'top':\n        cropperPosition.y1 = Math.min(Math.max(moveStart.y1 + moveY, cropperPosition.y2 - settings.cropperScaledMaxHeight),\n          cropperPosition.y2 - settings.cropperScaledMinHeight);\n        break;\n      case 'topright':\n        cropperPosition.x2 = Math.max(Math.min(moveStart.x2 + moveX, cropperPosition.x1 + settings.cropperScaledMaxWidth),\n          cropperPosition.x1 + settings.cropperScaledMinWidth);\n        cropperPosition.y1 = Math.min(Math.max(moveStart.y1 + moveY, cropperPosition.y2 - settings.cropperScaledMaxHeight),\n          cropperPosition.y2 - settings.cropperScaledMinHeight);\n        break;\n      case 'right':\n        cropperPosition.x2 = Math.max(Math.min(moveStart.x2 + moveX, cropperPosition.x1 + settings.cropperScaledMaxWidth),\n          cropperPosition.x1 + settings.cropperScaledMinWidth);\n        break;\n      case 'bottomright':\n        cropperPosition.x2 = Math.max(Math.min(moveStart.x2 + moveX, cropperPosition.x1 + settings.cropperScaledMaxWidth),\n          cropperPosition.x1 + settings.cropperScaledMinWidth);\n        cropperPosition.y2 = Math.max(Math.min(moveStart.y2 + moveY, cropperPosition.y1 + settings.cropperScaledMaxHeight),\n          cropperPosition.y1 + settings.cropperScaledMinHeight);\n        break;\n      case 'bottom':\n        cropperPosition.y2 = Math.max(Math.min(moveStart.y2 + moveY, cropperPosition.y1 + settings.cropperScaledMaxHeight),\n          cropperPosition.y1 + settings.cropperScaledMinHeight);\n        break;\n      case 'bottomleft':\n        cropperPosition.x1 = Math.min(Math.max(moveStart.x1 + moveX, cropperPosition.x2 - settings.cropperScaledMaxWidth),\n          cropperPosition.x2 - settings.cropperScaledMinWidth);\n        cropperPosition.y2 = Math.max(Math.min(moveStart.y2 + moveY, cropperPosition.y1 + settings.cropperScaledMaxHeight),\n          cropperPosition.y1 + settings.cropperScaledMinHeight);\n        break;\n      case 'center':\n        const scale = event.scale;\n        const newWidth = Math.min(\n          Math.max(settings.cropperScaledMinWidth, (Math.abs(moveStart.x2 - moveStart.x1)) * scale),\n          settings.cropperScaledMaxWidth);\n        const newHeight = Math.min(\n          Math.max(settings.cropperScaledMinHeight, (Math.abs(moveStart.y2 - moveStart.y1)) * scale),\n          settings.cropperScaledMaxHeight);\n        cropperPosition.x1 = moveStart.clientX - newWidth / 2;\n        cropperPosition.x2 = moveStart.clientX + newWidth / 2;\n        cropperPosition.y1 = moveStart.clientY - newHeight / 2;\n        cropperPosition.y2 = moveStart.clientY + newHeight / 2;\n        if (cropperPosition.x1 < 0) {\n          cropperPosition.x2 -= cropperPosition.x1;\n          cropperPosition.x1 = 0;\n        } else if (cropperPosition.x2 > maxSize.width) {\n          cropperPosition.x1 -= (cropperPosition.x2 - maxSize.width);\n          cropperPosition.x2 = maxSize.width;\n        }\n        if (cropperPosition.y1 < 0) {\n          cropperPosition.y2 -= cropperPosition.y1;\n          cropperPosition.y1 = 0;\n        } else if (cropperPosition.y2 > maxSize.height) {\n          cropperPosition.y1 -= (cropperPosition.y2 - maxSize.height);\n          cropperPosition.y2 = maxSize.height;\n        }\n        break;\n    }\n\n    if (settings.maintainAspectRatio) {\n      this.checkAspectRatio(moveStart.position, cropperPosition, maxSize, settings);\n    }\n  }\n\n  checkAspectRatio(position: string, cropperPosition: CropperPosition, maxSize: Dimensions, settings: CropperSettings): void {\n    let overflowX = 0;\n    let overflowY = 0;\n\n    switch (position) {\n      case 'top':\n        cropperPosition.x2 = cropperPosition.x1 + (cropperPosition.y2 - cropperPosition.y1) * settings.aspectRatio;\n        overflowX = Math.max(cropperPosition.x2 - maxSize.width, 0);\n        overflowY = Math.max(0 - cropperPosition.y1, 0);\n        if (overflowX > 0 || overflowY > 0) {\n          cropperPosition.x2 -= (overflowY * settings.aspectRatio) > overflowX ? (overflowY * settings.aspectRatio) : overflowX;\n          cropperPosition.y1 += (overflowY * settings.aspectRatio) > overflowX ? overflowY : overflowX / settings.aspectRatio;\n        }\n        break;\n      case 'bottom':\n        cropperPosition.x2 = cropperPosition.x1 + (cropperPosition.y2 - cropperPosition.y1) * settings.aspectRatio;\n        overflowX = Math.max(cropperPosition.x2 - maxSize.width, 0);\n        overflowY = Math.max(cropperPosition.y2 - maxSize.height, 0);\n        if (overflowX > 0 || overflowY > 0) {\n          cropperPosition.x2 -= (overflowY * settings.aspectRatio) > overflowX ? (overflowY * settings.aspectRatio) : overflowX;\n          cropperPosition.y2 -= (overflowY * settings.aspectRatio) > overflowX ? overflowY : (overflowX / settings.aspectRatio);\n        }\n        break;\n      case 'topleft':\n        cropperPosition.y1 = cropperPosition.y2 - (cropperPosition.x2 - cropperPosition.x1) / settings.aspectRatio;\n        overflowX = Math.max(0 - cropperPosition.x1, 0);\n        overflowY = Math.max(0 - cropperPosition.y1, 0);\n        if (overflowX > 0 || overflowY > 0) {\n          cropperPosition.x1 += (overflowY * settings.aspectRatio) > overflowX ? (overflowY * settings.aspectRatio) : overflowX;\n          cropperPosition.y1 += (overflowY * settings.aspectRatio) > overflowX ? overflowY : overflowX / settings.aspectRatio;\n        }\n        break;\n      case 'topright':\n        cropperPosition.y1 = cropperPosition.y2 - (cropperPosition.x2 - cropperPosition.x1) / settings.aspectRatio;\n        overflowX = Math.max(cropperPosition.x2 - maxSize.width, 0);\n        overflowY = Math.max(0 - cropperPosition.y1, 0);\n        if (overflowX > 0 || overflowY > 0) {\n          cropperPosition.x2 -= (overflowY * settings.aspectRatio) > overflowX ? (overflowY * settings.aspectRatio) : overflowX;\n          cropperPosition.y1 += (overflowY * settings.aspectRatio) > overflowX ? overflowY : overflowX / settings.aspectRatio;\n        }\n        break;\n      case 'right':\n      case 'bottomright':\n        cropperPosition.y2 = cropperPosition.y1 + (cropperPosition.x2 - cropperPosition.x1) / settings.aspectRatio;\n        overflowX = Math.max(cropperPosition.x2 - maxSize.width, 0);\n        overflowY = Math.max(cropperPosition.y2 - maxSize.height, 0);\n        if (overflowX > 0 || overflowY > 0) {\n          cropperPosition.x2 -= (overflowY * settings.aspectRatio) > overflowX ? (overflowY * settings.aspectRatio) : overflowX;\n          cropperPosition.y2 -= (overflowY * settings.aspectRatio) > overflowX ? overflowY : overflowX / settings.aspectRatio;\n        }\n        break;\n      case 'left':\n      case 'bottomleft':\n        cropperPosition.y2 = cropperPosition.y1 + (cropperPosition.x2 - cropperPosition.x1) / settings.aspectRatio;\n        overflowX = Math.max(0 - cropperPosition.x1, 0);\n        overflowY = Math.max(cropperPosition.y2 - maxSize.height, 0);\n        if (overflowX > 0 || overflowY > 0) {\n          cropperPosition.x1 += (overflowY * settings.aspectRatio) > overflowX ? (overflowY * settings.aspectRatio) : overflowX;\n          cropperPosition.y2 -= (overflowY * settings.aspectRatio) > overflowX ? overflowY : overflowX / settings.aspectRatio;\n        }\n        break;\n      case 'center':\n        cropperPosition.x2 = cropperPosition.x1 + (cropperPosition.y2 - cropperPosition.y1) * settings.aspectRatio;\n        cropperPosition.y2 = cropperPosition.y1 + (cropperPosition.x2 - cropperPosition.x1) / settings.aspectRatio;\n        const overflowX1 = Math.max(0 - cropperPosition.x1, 0);\n        const overflowX2 = Math.max(cropperPosition.x2 - maxSize.width, 0);\n        const overflowY1 = Math.max(cropperPosition.y2 - maxSize.height, 0);\n        const overflowY2 = Math.max(0 - cropperPosition.y1, 0);\n        if (overflowX1 > 0 || overflowX2 > 0 || overflowY1 > 0 || overflowY2 > 0) {\n          cropperPosition.x1 += (overflowY1 * settings.aspectRatio) > overflowX1 ? (overflowY1 * settings.aspectRatio) : overflowX1;\n          cropperPosition.x2 -= (overflowY2 * settings.aspectRatio) > overflowX2 ? (overflowY2 * settings.aspectRatio) : overflowX2;\n          cropperPosition.y1 += (overflowY2 * settings.aspectRatio) > overflowX2 ? overflowY2 : overflowX2 / settings.aspectRatio;\n          cropperPosition.y2 -= (overflowY1 * settings.aspectRatio) > overflowX1 ? overflowY1 : overflowX1 / settings.aspectRatio;\n        }\n        break;\n    }\n  }\n\n  getClientX(event: any): number {\n    return (event.touches && event.touches[0] ? event.touches[0].clientX : event.clientX) || 0;\n  }\n\n  getClientY(event: any): number {\n    return (event.touches && event.touches[0] ? event.touches[0].clientY : event.clientY) || 0;\n  }\n}\n","export function getPositionForKey(key: string): string {\n  switch (key) {\n    case 'ArrowUp':\n      return 'top';\n    case 'ArrowRight':\n      return 'right';\n    case 'ArrowDown':\n      return 'bottom';\n    case 'ArrowLeft':\n    default:\n      return 'left';\n  }\n}\n\nexport function getInvertedPositionForKey(key: string): string {\n  switch (key) {\n    case 'ArrowUp':\n      return 'bottom';\n    case 'ArrowRight':\n      return 'left';\n    case 'ArrowDown':\n      return 'top';\n    case 'ArrowLeft':\n    default:\n      return 'right';\n  }\n}\n\nexport function getEventForKey(key: string, stepSize: number): any {\n  switch (key) {\n    case 'ArrowUp':\n      return {clientX: 0, clientY: stepSize * -1};\n    case 'ArrowRight':\n      return {clientX: stepSize, clientY: 0};\n    case 'ArrowDown':\n      return {clientX: 0, clientY: stepSize};\n    case 'ArrowLeft':\n    default:\n      return {clientX: stepSize * -1, clientY: 0};\n  }\n}\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostBinding,\n  HostListener,\n  Input,\n  isDevMode,\n  OnChanges,\n  OnInit,\n  Output,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\nimport { DomSanitizer, SafeStyle, SafeUrl } from '@angular/platform-browser';\nimport { CropperPosition, Dimensions, ImageCroppedEvent, ImageTransform, LoadedImage, MoveStart } from '../interfaces';\nimport { MoveTypes } from '../interfaces/move-start.interface';\nimport { HammerStatic } from '../utils/hammer.utils';\nimport { CropService } from '../services/crop.service';\nimport { CropperSettings } from '../interfaces/cropper.settings';\nimport { LoadImageService } from '../services/load-image.service';\nimport { OutputFormat } from '../interfaces/cropper-options.interface';\nimport { CropperPositionService } from '../services/cropper-position.service';\nimport { getEventForKey, getInvertedPositionForKey, getPositionForKey } from '../utils/keyboard.utils';\n\n@Component({\n  selector: 'image-cropper',\n  templateUrl: './image-cropper.component.html',\n  styleUrls: ['./image-cropper.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ImageCropperComponent implements OnChanges, OnInit {\n  private Hammer: HammerStatic = typeof window !== 'undefined'\n    ? (window as any).Hammer as HammerStatic\n    : null;\n  private settings = new CropperSettings();\n  private setImageMaxSizeRetries = 0;\n  private moveStart: MoveStart;\n  private loadedImage: LoadedImage;\n\n  safeImgDataUrl: SafeUrl | string;\n  safeTransformStyle: SafeStyle | string;\n  marginLeft: SafeStyle | string = '0px';\n  maxSize: Dimensions;\n  moveTypes = MoveTypes;\n  imageVisible = false;\n\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef<HTMLDivElement>;\n  @ViewChild('sourceImage', {static: false}) sourceImage: ElementRef<HTMLDivElement>;\n\n  @Input() imageChangedEvent: any;\n  @Input() imageURL: string;\n  @Input() imageBase64: string;\n  @Input() imageFile: File;\n\n  @Input() format: OutputFormat = this.settings.format;\n  @Input() transform: ImageTransform = {};\n  @Input() maintainAspectRatio = this.settings.maintainAspectRatio;\n  @Input() aspectRatio = this.settings.aspectRatio;\n  @Input() resizeToWidth = this.settings.resizeToWidth;\n  @Input() resizeToHeight = this.settings.resizeToHeight;\n  @Input() cropperMinWidth = this.settings.cropperMinWidth;\n  @Input() cropperMinHeight = this.settings.cropperMinHeight;\n  @Input() cropperMaxHeight = this.settings.cropperMaxHeight;\n  @Input() cropperMaxWidth = this.settings.cropperMaxWidth;\n  @Input() cropperStaticWidth = this.settings.cropperStaticWidth;\n  @Input() cropperStaticHeight = this.settings.cropperStaticHeight;\n  @Input() canvasRotation = this.settings.canvasRotation;\n  @Input() initialStepSize = this.settings.initialStepSize;\n  @Input() roundCropper = this.settings.roundCropper;\n  @Input() onlyScaleDown = this.settings.onlyScaleDown;\n  @Input() imageQuality = this.settings.imageQuality;\n  @Input() autoCrop = this.settings.autoCrop;\n  @Input() backgroundColor = this.settings.backgroundColor;\n  @Input() containWithinAspectRatio = this.settings.containWithinAspectRatio;\n  @Input() hideResizeSquares = this.settings.hideResizeSquares;\n  @Input() cropper: CropperPosition = {\n    x1: -100,\n    y1: -100,\n    x2: 10000,\n    y2: 10000\n  };\n  @HostBinding('style.text-align')\n  @Input() alignImage: 'left' | 'center' = this.settings.alignImage;\n  @HostBinding('class.disabled')\n  @Input() disabled = false;\n\n  @Output() imageCropped = new EventEmitter<ImageCroppedEvent>();\n  @Output() startCropImage = new EventEmitter<void>();\n  @Output() imageLoaded = new EventEmitter<LoadedImage>();\n  @Output() cropperReady = new EventEmitter<Dimensions>();\n  @Output() loadImageFailed = new EventEmitter<void>();\n\n  constructor(\n    private cropService: CropService,\n    private cropperPositionService: CropperPositionService,\n    private loadImageService: LoadImageService,\n    private sanitizer: DomSanitizer,\n    private cd: ChangeDetectorRef\n  ) {\n    this.reset();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.onChangesUpdateSettings(changes);\n    this.onChangesInputImage(changes);\n\n    if (this.loadedImage && this.loadedImage.original.image.complete\n      && (changes.containWithinAspectRatio || changes.canvasRotation)) {\n      this.loadImageService\n        .transformLoadedImage(this.loadedImage, this.settings)\n        .then((res) => this.setLoadedImage(res))\n        .catch((err) => this.loadImageError(err));\n    }\n    if (changes.cropper) {\n      this.setMaxSize();\n      this.setCropperScaledMinSize();\n      this.setCropperScaledMaxSize();\n      this.checkCropperPosition(false);\n      this.doAutoCrop();\n      this.cd.markForCheck();\n    }\n    if (changes.aspectRatio && this.imageVisible) {\n      this.resetCropperPosition();\n    }\n    if (changes.transform) {\n      this.transform = this.transform || {};\n      this.setCssTransform();\n      this.doAutoCrop();\n    }\n  }\n\n  private onChangesUpdateSettings(changes: SimpleChanges) {\n    this.settings.setOptionsFromChanges(changes);\n\n    if (this.settings.cropperStaticHeight && this.settings.cropperStaticWidth) {\n      this.settings.setOptions({\n        hideResizeSquares: true,\n        cropperMinWidth: this.settings.cropperStaticWidth,\n        cropperMinHeight: this.settings.cropperStaticHeight,\n        cropperMaxHeight: this.settings.cropperStaticHeight,\n        cropperMaxWidth: this.settings.cropperStaticWidth,\n        maintainAspectRatio: false\n      });\n    }\n  }\n\n  private onChangesInputImage(changes: SimpleChanges): void {\n    if (changes.imageChangedEvent || changes.imageURL || changes.imageBase64 || changes.imageFile) {\n      this.reset();\n    }\n    if (changes.imageChangedEvent && this.isValidImageChangedEvent()) {\n      this.loadImageFile(this.imageChangedEvent.target.files[0]);\n    }\n    if (changes.imageURL && this.imageURL) {\n      this.loadImageFromURL(this.imageURL);\n    }\n    if (changes.imageBase64 && this.imageBase64) {\n      this.loadBase64Image(this.imageBase64);\n    }\n    if (changes.imageFile && this.imageFile) {\n      this.loadImageFile(this.imageFile);\n    }\n  }\n\n  private isValidImageChangedEvent(): boolean {\n    return this.imageChangedEvent\n      && this.imageChangedEvent.target\n      && this.imageChangedEvent.target.files\n      && this.imageChangedEvent.target.files.length > 0;\n  }\n\n  private setCssTransform() {\n    this.safeTransformStyle = this.sanitizer.bypassSecurityTrustStyle(\n      'scaleX(' + (this.transform.scale || 1) * (this.transform.flipH ? -1 : 1) + ')' +\n      'scaleY(' + (this.transform.scale || 1) * (this.transform.flipV ? -1 : 1) + ')' +\n      'rotate(' + (this.transform.rotate || 0) + 'deg)'\n    );\n  }\n\n  ngOnInit(): void {\n    this.settings.stepSize = this.initialStepSize;\n    this.activatePinchGesture();\n  }\n\n  private reset(): void {\n    this.imageVisible = false;\n    this.loadedImage = null;\n    this.safeImgDataUrl = 'data:image/png;base64,iVBORw0KGg'\n      + 'oAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAU'\n      + 'AAarVyFEAAAAASUVORK5CYII=';\n    this.moveStart = {\n      active: false,\n      type: null,\n      position: null,\n      x1: 0,\n      y1: 0,\n      x2: 0,\n      y2: 0,\n      clientX: 0,\n      clientY: 0\n    };\n    this.maxSize = {\n      width: 0,\n      height: 0\n    };\n    this.cropper.x1 = -100;\n    this.cropper.y1 = -100;\n    this.cropper.x2 = 10000;\n    this.cropper.y2 = 10000;\n  }\n\n  private loadImageFile(file: File): void {\n    this.loadImageService\n      .loadImageFile(file, this.settings)\n      .then((res) => this.setLoadedImage(res))\n      .catch((err) => this.loadImageError(err));\n  }\n\n  private loadBase64Image(imageBase64: string): void {\n    this.loadImageService\n      .loadBase64Image(imageBase64, this.settings)\n      .then((res) => this.setLoadedImage(res))\n      .catch((err) => this.loadImageError(err));\n  }\n\n  private loadImageFromURL(url: string): void {\n    this.loadImageService\n      .loadImageFromURL(url, this.settings)\n      .then((res) => this.setLoadedImage(res))\n      .catch((err) => this.loadImageError(err));\n  }\n\n  private setLoadedImage(loadedImage: LoadedImage): void {\n    this.loadedImage = loadedImage;\n    this.safeImgDataUrl = this.sanitizer.bypassSecurityTrustResourceUrl(loadedImage.transformed.base64);\n    this.cd.markForCheck();\n  }\n\n  private loadImageError(error: any): void {\n    console.error(error);\n    this.loadImageFailed.emit();\n  }\n\n  imageLoadedInView(): void {\n    if (this.loadedImage != null) {\n      this.imageLoaded.emit(this.loadedImage);\n      this.setImageMaxSizeRetries = 0;\n      setTimeout(() => this.checkImageMaxSizeRecursively());\n    }\n  }\n\n  private checkImageMaxSizeRecursively(): void {\n    if (this.setImageMaxSizeRetries > 40) {\n      this.loadImageFailed.emit();\n    } else if (this.sourceImageLoaded()) {\n      this.setMaxSize();\n      this.setCropperScaledMinSize();\n      this.setCropperScaledMaxSize();\n      this.resetCropperPosition();\n      this.cropperReady.emit({...this.maxSize});\n      this.cd.markForCheck();\n    } else {\n      this.setImageMaxSizeRetries++;\n      setTimeout(() => this.checkImageMaxSizeRecursively(), 50);\n    }\n  }\n\n  private sourceImageLoaded(): boolean {\n    return this.sourceImage && this.sourceImage.nativeElement && this.sourceImage.nativeElement.offsetWidth > 0;\n  }\n\n  @HostListener('window:resize')\n  onResize(): void {\n    if (!this.loadedImage) {\n      return;\n    }\n    this.resizeCropperPosition();\n    this.setMaxSize();\n    this.setCropperScaledMinSize();\n    this.setCropperScaledMaxSize();\n  }\n\n  private activatePinchGesture() {\n    if (this.Hammer) {\n      const hammer = new this.Hammer(this.wrapper.nativeElement);\n      hammer.get('pinch').set({enable: true});\n      hammer.on('pinchmove', this.onPinch.bind(this));\n      hammer.on('pinchend', this.pinchStop.bind(this));\n      hammer.on('pinchstart', this.startPinch.bind(this));\n    } else if (isDevMode()) {\n      console.warn('[NgxImageCropper] Could not find HammerJS - Pinch Gesture won\\'t work');\n    }\n  }\n\n  private resizeCropperPosition(): void {\n    const sourceImageElement = this.sourceImage.nativeElement;\n    if (this.maxSize.width !== sourceImageElement.offsetWidth || this.maxSize.height !== sourceImageElement.offsetHeight) {\n      this.cropper.x1 = this.cropper.x1 * sourceImageElement.offsetWidth / this.maxSize.width;\n      this.cropper.x2 = this.cropper.x2 * sourceImageElement.offsetWidth / this.maxSize.width;\n      this.cropper.y1 = this.cropper.y1 * sourceImageElement.offsetHeight / this.maxSize.height;\n      this.cropper.y2 = this.cropper.y2 * sourceImageElement.offsetHeight / this.maxSize.height;\n    }\n  }\n\n  resetCropperPosition(): void {\n    this.cropperPositionService.resetCropperPosition(this.sourceImage, this.cropper, this.settings);\n    this.doAutoCrop();\n    this.imageVisible = true;\n  }\n\n  keyboardAccess(event: any) {\n    this.changeKeyboardStepSize(event);\n    this.keyboardMoveCropper(event);\n  }\n\n  private changeKeyboardStepSize(event: any): void {\n    if (event.key >= '1' && event.key <= '9') {\n      this.settings.stepSize = +event.key;\n      return;\n    }\n  }\n\n  private keyboardMoveCropper(event) {\n    const keyboardWhiteList: string[] = ['ArrowUp', 'ArrowDown', 'ArrowRight', 'ArrowLeft'];\n    if (!(keyboardWhiteList.includes(event.key))) {\n      return;\n    }\n    const moveType = event.shiftKey ? MoveTypes.Resize : MoveTypes.Move;\n    const position = event.altKey ? getInvertedPositionForKey(event.key) : getPositionForKey(event.key);\n    const moveEvent = getEventForKey(event.key, this.settings.stepSize);\n    event.preventDefault();\n    event.stopPropagation();\n    this.startMove({clientX: 0, clientY: 0}, moveType, position);\n    this.moveImg(moveEvent);\n    this.moveStop();\n  }\n\n  startMove(event: any, moveType: MoveTypes, position: string | null = null): void {\n    if (this.moveStart && this.moveStart.active && this.moveStart.type === MoveTypes.Pinch) {\n      return;\n    }\n    if (event.preventDefault) {\n      event.preventDefault();\n    }\n    this.moveStart = {\n      active: true,\n      type: moveType,\n      position,\n      clientX: this.cropperPositionService.getClientX(event),\n      clientY: this.cropperPositionService.getClientY(event),\n      ...this.cropper\n    };\n  }\n\n  startPinch(event: any) {\n    if (!this.safeImgDataUrl) {\n      return;\n    }\n    if (event.preventDefault) {\n      event.preventDefault();\n    }\n    this.moveStart = {\n      active: true,\n      type: MoveTypes.Pinch,\n      position: 'center',\n      clientX: this.cropper.x1 + (this.cropper.x2 - this.cropper.x1) / 2,\n      clientY: this.cropper.y1 + (this.cropper.y2 - this.cropper.y1) / 2,\n      ...this.cropper\n    };\n  }\n\n  @HostListener('document:mousemove', ['$event'])\n  @HostListener('document:touchmove', ['$event'])\n  moveImg(event: any): void {\n    if (this.moveStart.active) {\n      if (event.stopPropagation) {\n        event.stopPropagation();\n      }\n      if (event.preventDefault) {\n        event.preventDefault();\n      }\n      if (this.moveStart.type === MoveTypes.Move) {\n        this.cropperPositionService.move(event, this.moveStart, this.cropper);\n        this.checkCropperPosition(true);\n      } else if (this.moveStart.type === MoveTypes.Resize) {\n        if (!this.cropperStaticWidth && !this.cropperStaticHeight) {\n          this.cropperPositionService.resize(event, this.moveStart, this.cropper, this.maxSize, this.settings);\n        }\n        this.checkCropperPosition(false);\n      }\n      this.cd.detectChanges();\n    }\n  }\n\n  onPinch(event: any) {\n    if (this.moveStart.active) {\n      if (event.stopPropagation) {\n        event.stopPropagation();\n      }\n      if (event.preventDefault) {\n        event.preventDefault();\n      }\n      if (this.moveStart.type === MoveTypes.Pinch) {\n        this.cropperPositionService.resize(event, this.moveStart, this.cropper, this.maxSize, this.settings);\n        this.checkCropperPosition(false);\n      }\n      this.cd.detectChanges();\n    }\n  }\n\n  private setMaxSize(): void {\n    if (this.sourceImage) {\n      const sourceImageElement = this.sourceImage.nativeElement;\n      this.maxSize.width = sourceImageElement.offsetWidth;\n      this.maxSize.height = sourceImageElement.offsetHeight;\n      this.marginLeft = this.sanitizer.bypassSecurityTrustStyle('calc(50% - ' + this.maxSize.width / 2 + 'px)');\n    }\n  }\n\n  private setCropperScaledMinSize(): void {\n    if (this.loadedImage && this.loadedImage.transformed && this.loadedImage.transformed.image) {\n      this.setCropperScaledMinWidth();\n      this.setCropperScaledMinHeight();\n    } else {\n      this.settings.cropperScaledMinWidth = 20;\n      this.settings.cropperScaledMinHeight = 20;\n    }\n  }\n\n  private setCropperScaledMinWidth(): void {\n    this.settings.cropperScaledMinWidth = this.cropperMinWidth > 0\n      ? Math.max(20, this.cropperMinWidth / this.loadedImage.transformed.image.width * this.maxSize.width)\n      : 20;\n  }\n\n  private setCropperScaledMinHeight(): void {\n    if (this.maintainAspectRatio) {\n      this.settings.cropperScaledMinHeight = Math.max(20, this.settings.cropperScaledMinWidth / this.aspectRatio);\n    } else if (this.cropperMinHeight > 0) {\n      this.settings.cropperScaledMinHeight = Math.max(\n        20,\n        this.cropperMinHeight / this.loadedImage.transformed.image.height * this.maxSize.height\n      );\n    } else {\n      this.settings.cropperScaledMinHeight = 20;\n    }\n  }\n\n  private setCropperScaledMaxSize(): void {\n    if (this.loadedImage && this.loadedImage.transformed && this.loadedImage.transformed.image) {\n      const ratio = this.loadedImage.transformed.size.width / this.maxSize.width;\n      this.settings.cropperScaledMaxWidth = this.cropperMaxWidth > 20 ? this.cropperMaxWidth / ratio : this.maxSize.width;\n      this.settings.cropperScaledMaxHeight = this.cropperMaxHeight > 20 ? this.cropperMaxHeight / ratio : this.maxSize.height;\n      if (this.maintainAspectRatio) {\n        if (this.settings.cropperScaledMaxWidth > this.settings.cropperScaledMaxHeight * this.aspectRatio) {\n          this.settings.cropperScaledMaxWidth = this.settings.cropperScaledMaxHeight * this.aspectRatio;\n        } else if (this.settings.cropperScaledMaxWidth < this.settings.cropperScaledMaxHeight * this.aspectRatio) {\n          this.settings.cropperScaledMaxHeight = this.settings.cropperScaledMaxWidth / this.aspectRatio;\n        }\n      }\n    } else {\n      this.settings.cropperScaledMaxWidth = this.maxSize.width;\n      this.settings.cropperScaledMaxHeight = this.maxSize.height;\n    }\n  }\n\n  private checkCropperPosition(maintainSize = false): void {\n    if (this.cropper.x1 < 0) {\n      this.cropper.x2 -= maintainSize ? this.cropper.x1 : 0;\n      this.cropper.x1 = 0;\n    }\n    if (this.cropper.y1 < 0) {\n      this.cropper.y2 -= maintainSize ? this.cropper.y1 : 0;\n      this.cropper.y1 = 0;\n    }\n    if (this.cropper.x2 > this.maxSize.width) {\n      this.cropper.x1 -= maintainSize ? (this.cropper.x2 - this.maxSize.width) : 0;\n      this.cropper.x2 = this.maxSize.width;\n    }\n    if (this.cropper.y2 > this.maxSize.height) {\n      this.cropper.y1 -= maintainSize ? (this.cropper.y2 - this.maxSize.height) : 0;\n      this.cropper.y2 = this.maxSize.height;\n    }\n  }\n\n  @HostListener('document:mouseup')\n  @HostListener('document:touchend')\n  moveStop(): void {\n    if (this.moveStart.active) {\n      this.moveStart.active = false;\n      this.doAutoCrop();\n    }\n  }\n\n  pinchStop(): void {\n    if (this.moveStart.active) {\n      this.moveStart.active = false;\n      this.doAutoCrop();\n    }\n  }\n\n  private doAutoCrop(): void {\n    if (this.autoCrop) {\n      this.crop();\n    }\n  }\n\n  crop(): ImageCroppedEvent | null {\n    if (this.sourceImage && this.sourceImage.nativeElement && this.loadedImage.transformed.image != null) {\n      this.startCropImage.emit();\n      const output = this.cropService.crop(this.sourceImage, this.loadedImage, this.cropper, this.settings);\n      if (output != null) {\n        this.imageCropped.emit(output);\n      }\n      return output;\n    }\n    return null;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ImageCropperComponent } from './component/image-cropper.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    ImageCropperComponent\n  ],\n  exports: [\n    ImageCropperComponent\n  ]\n})\nexport class ImageCropperModule {\n}\n","export function base64ToFile(base64Image: string): Blob {\n  const split = base64Image.split(',');\n  const type = split[0].replace('data:', '').replace(';base64', '');\n  const byteString = atob(split[1]);\n  const ab = new ArrayBuffer(byteString.length);\n  const ia = new Uint8Array(ab);\n  for (let i = 0; i < byteString.length; i += 1) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n  return new Blob([ab], {type});\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CropPage } from './crop.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CropPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CropPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CropPageRoutingModule } from './crop-routing.module';\n\nimport { CropPage } from './crop.page';\n\nimport { ImageCropperModule } from 'ngx-image-cropper';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CropPageRoutingModule,\n    ImageCropperModule\n  ],\n  declarations: [CropPage]\n})\nexport class CropPageModule {}\n"],"sourceRoot":"webpack:///"}