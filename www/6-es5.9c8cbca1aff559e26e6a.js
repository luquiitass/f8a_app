!function(){function e(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==i.return||i.return()}finally{if(c)throw a}}}}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{fSJy:function(e,n,i){"use strict";i.d(n,"a",(function(){return j}));var r,c=i("mrSG"),u=i("8xVP"),d=i("9suA"),f=i("4R65"),b=i("fXoL"),p=i("G/jy"),m=i("vuFD"),h=i("TEn/"),v=i("6/gD"),g=i("ofXK"),y=i("3Pt+"),k=((r=function(e){s(n,e);var t=l(n);function n(e,i,r,a,s,c){var l;return o(this,n),(l=t.call(this,c,r)).request=e,l.dialogService=i,l.viewCtrl=r,l.photoService=a,l.newMarker=null,l.modelField=new u.a("Field",e),l.id=s.get("id"),l}return a(n,[{key:"initObject",value:function(){var e=this;console.log("initObject"),this.field={name:"",lat:-27.603857971720405,lng:-55.323644024643414},navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){e.field.lat=t.coords.latitude,e.field.lng=t.coords.longitude,console.log("current pos",t)}),(function(e){console.error(e)})),this.id?this.modelField.api_find(this.id).subscribe((function(t){console.log("load field",t),"success"==t.status&&(e.field=t.Field,e.leafletMap(),e.addNewMarker())})):this.leafletMap()}},{key:"submit",value:function(){var e=this;this.field.id?this.modelField.api_update(this.field).subscribe((function(t){var n;"success"==t.status&&(e.dialogService.showToast(null!==(n=t.msjSuccess)&&void 0!==n?n:"Registrado"),e.dismiss(t.Field))})):this.modelField.api_create(this.field).subscribe((function(t){var n;"success"==t.status&&(e.dialogService.showToast(null!==(n=t.msjSuccess)&&void 0!==n?n:"Registrado"),e.dismiss(t.Field))}))}},{key:"dismiss",value:function(e){this.viewCtrl.dismiss({field:e})}},{key:"close",value:function(){this.viewCtrl.dismiss()}},{key:"leafletMap",value:function(){var e=this;this.reset(),this.map=f.map("mapId2"),this.map.on("load",(function(){console.log("load map"),setTimeout((function(){console.log("refresh"),e.regresh()}),1e3)})),this.map.setView([this.field.lat,this.field.lng],11),f.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"futbol8alem.com",id:"mapbox/streets-v11"}).addTo(this.map),this.map.on("contextmenu",(function(t){console.log("rightClick",t),e.field.lat=t.latlng.lat,e.field.lng=t.latlng.lng,e.addNewMarker()})),this.loadFields()}},{key:"addNewMarker",value:function(){var e=this;this.newMarker&&this.map.removeLayer(this.newMarker);var t=f.divIcon({className:"my-custom-pin",iconAnchor:[0,24],labelAnchor:[-6,0],popupAnchor:[0,-36],html:'<span style="\n      background-color: #35da7f;\n      width: 2rem;\n      height: 2rem;\n      display: block;\n      left: -1.5rem;\n      top: -1.5rem;\n      position: relative;\n      border-radius: 3rem 3rem 0;\n      transform: rotate(45deg);\n      border: 1px solid #FFFFFF" />'});this.newMarker=f.marker([this.field.lat,this.field.lng],{draggable:!0,alt:"Nueva Cancha",shadowPane:"Pane",icon:t,title:"Arrastra bara canbiar la ubicaci\xf3n."}).addTo(this.map),this.newMarker.on("dragend",(function(t){var n=t.target,i=n.getLatLng();e.field.lat=i.lat,e.field.lng=i.lng,n.openPopup(),console.log("change pos",e.field)})),this.newMarker.bindPopup(this.field.name,{autoPan:!1}).openPopup()}},{key:"loadFields",value:function(){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.id||this.modelField.api_function("markers").subscribe((function(e){"success"==e.status&&e.data&&e.data.forEach((function(e){t.addMarker(parseFloat(e.lat),parseFloat(e.lng),e.name)})),t.map.setView([t.field.lat,t.field.lng],11)}),(function(e){}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"addMarker",value:function(e,t,n){var i=f.icon({iconUrl:"http://icons.iconseeker.com/png/fullsize/sport-fields/football-field.png",iconSize:[30,40],iconAnchor:[15,40],shadowSize:[35,50],shadowAnchor:[0,55],popupAnchor:[0,-40]});0!=e&&0!=t&&f.marker([e,t],{icon:i}).addTo(this.map).bindTooltip(n,{permanent:!0}).openTooltip()}},{key:"inputVal",value:function(e){this.field.name=e,this.newMarker&&this.newMarker._popup.setContent(e,{autoPan:!1})}},{key:"regresh",value:function(){this.map.invalidateSize()}},{key:"reset",value:function(){this.map&&(this.map.off(),this.map.remove())}}]),n}(d.a)).\u0275fac=function(e){return new(e||r)(b.Lb(p.a),b.Lb(m.a),b.Lb(h.nb),b.Lb(v.a),b.Lb(h.pb),b.Lb(g.n))},r.\u0275cmp=b.Fb({type:r,selectors:[["app-field-form"]],features:[b.vb],decls:26,vars:2,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],[3,"ngSubmit","keyup"],[1,"info"],[1,"sug"],["position","floating"],["type","text","name","name",3,"value","input"],[2,"color","red","padding-top","0.2rem"],["id","mapId2",2,"min-width","100%","min-height","400px !important"],[1,"desc"],["expand","block",3,"click"]],template:function(e,t){1&e&&(b.Qb(0,"ion-header"),b.Qb(1,"ion-toolbar"),b.Qb(2,"ion-title"),b.vc(3,"Cancha"),b.Pb(),b.Qb(4,"ion-buttons",0),b.Qb(5,"ion-button",1),b.Yb("click",(function(){return t.close()})),b.Mb(6,"ion-icon",2),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(7,"ion-content"),b.Qb(8,"form",3),b.Yb("ngSubmit",(function(){return t.submit()}))("keyup",(function(){return t.modelField.errorsForm.clear()})),b.Qb(9,"div",4),b.vc(10," Ingrese un nombre para identificar la cancha "),b.Qb(11,"span",5),b.vc(12," (Recomendamos el NOMBRE DEL EQUIPO que utiliza la cancha o el NOMBRE DEL LUGAR donde se encuentra ubicado)"),b.Pb(),b.vc(13,", despu\xe9s seleccione la ubicaci\xf3n en el mapa. "),b.Pb(),b.Qb(14,"ion-item"),b.Qb(15,"ion-label",6),b.vc(16,"Nombre"),b.Pb(),b.Qb(17,"ion-input",7),b.Yb("input",(function(e){return t.inputVal(e.target.value)})),b.Pb(),b.Pb(),b.Qb(18,"div",8),b.vc(19),b.Pb(),b.Mb(20,"br"),b.Mb(21,"div",9),b.Qb(22,"div",10),b.vc(23," Mant\xe9n presionado la ubicaci\xf3n en el mapa para a\xf1adir la ubicaci\xf3n. "),b.Pb(),b.Qb(24,"ion-button",11),b.Yb("click",(function(){return t.submit()})),b.vc(25,"Guardar"),b.Pb(),b.Pb(),b.Pb()),2&e&&(b.yb(17),b.gc("value",t.field.name),b.yb(2),b.wc(t.modelField.errorsForm.get("name")))},directives:[h.x,h.jb,h.hb,h.j,h.i,h.y,h.r,y.i,y.e,y.f,h.D,h.G,h.C,h.vb],styles:["#mapId[_ngcontent-%COMP%], #mapId2[_ngcontent-%COMP%]{min-width:100%!important;min-height:300px!important}.desc[_ngcontent-%COMP%]{margin:10px}.info[_ngcontent-%COMP%]{color:#babdbf;margin:15px}.sug[_ngcontent-%COMP%]{color:#727475}"]}),r),w=i("qsXW"),P=i("rLe3"),F=i("2Rin"),Q=i("y/q6"),S=i("EbHZ");function C(e,t){if(1&e){var n=b.Rb();b.Qb(0,"ion-button",4),b.Yb("click",(function(){b.oc(n);var e=b.ac();return e.canEdit=!e.canEdit})),b.Mb(1,"ion-icon",11),b.Pb()}}function M(e,t){if(1&e){var n=b.Rb();b.Qb(0,"ion-segment",12),b.Yb("ionChange",(function(e){return b.oc(n),b.ac().segmentChanged(e)})),b.Qb(1,"ion-segment-button",13),b.Qb(2,"ion-label"),b.vc(3,"Lista"),b.Pb(),b.Pb(),b.Qb(4,"ion-segment-button",14),b.Qb(5,"ion-label"),b.vc(6,"Mapa"),b.Pb(),b.Pb(),b.Pb()}if(2&e){var i=b.ac();b.gc("value",i.segment_select)}}function L(e,t){1&e&&(b.Qb(0,"ion-item"),b.Qb(1,"label"),b.vc(2,"No se han encontrado registros"),b.Pb(),b.Pb())}function x(e,t){if(1&e){var n=b.Rb();b.Qb(0,"ion-button",4),b.Yb("click",(function(e){b.oc(n);var t=b.ac(2).$implicit;return b.ac().showEdit(t,e)})),b.Mb(1,"ion-icon",17),b.Pb()}}function O(e,t){if(1&e){var n=b.Rb();b.Qb(0,"ion-button",4),b.Yb("click",(function(e){b.oc(n);var t=b.ac(2).$implicit;return b.ac().confirmDelete(t,e)})),b.Mb(1,"ion-icon",18),b.Pb()}}function A(e,t){if(1&e&&(b.Qb(0,"ion-buttons",16),b.uc(1,x,2,0,"ion-button",3),b.uc(2,O,2,0,"ion-button",3),b.Pb()),2&e){var n=b.ac().$implicit,i=b.ac();b.yb(1),b.gc("ngIf",!n.team_id),b.yb(1),b.gc("ngIf",i.authUser.isAdmin())}}function I(e,t){if(1&e){var n=b.Rb();b.Qb(0,"ion-item",4),b.Yb("click",(function(){b.oc(n);var e=t.$implicit;return b.ac().dismiss(e)})),b.Qb(1,"label",4),b.Yb("click",(function(e){b.oc(n);var i=t.$implicit;return b.ac().show(i,e)})),b.vc(2),b.Pb(),b.uc(3,A,3,2,"ion-buttons",15),b.Pb()}if(2&e){var i=t.$implicit,o=b.ac();b.yb(2),b.wc(i.name),b.yb(1),b.gc("ngIf",o.canEdit)}}var R,j=((R=function(e){s(i,e);var n=l(i);function i(e,t,r,a,s,c,l,d,f,b){var p;return o(this,i),(p=n.call(this,c,l)).requestService=e,p.dialogService=t,p.modalController=r,p.utilArray=a,p.util=s,p.viewCtrl=l,p.dialog=d,p.authUser=f,p.transfDat=b,p.segment_select="list",p.fields=[],p.oldFields=[],p.markers=[],p.canEdit=!1,p.isSelect=!1,p.modelField=new u.a("Field",e),p.isSelect=b.getData("isSelect"),b.clear(),p}return a(i,[{key:"ngOnInit",value:function(){this.init()}},{key:"init",value:function(){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dialogService.loadingProgres();case 2:this.modelField.api_function("pageAllFields").subscribe((function(e){"success"==e.status&&(t.fields=e.data,t.oldFields=t.fields),t.leafletMap(),t.dialogService.dimissLoaging()}),(function(e){t.dialogService.dimissLoaging(),t.dialogService.showToast("Error al obtener Campos","","warning")}));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"add",value:function(){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:k});case 2:return(t=e.sent).onDidDismiss().then((function(e){e.data&&e.data.field&&n.utilArray.listAddFirst(n.fields,e.data.field)})),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"filterField",value:function(e){var n=e.target.value;if(n.length<=0)return this.fields=this.oldFields,void this.loadFields();this.fields=t(this.oldFields),this.fields=this.fields.filter((function(e){return e.name.toUpperCase().includes(n.toUpperCase())})),this.loadFields()}},{key:"cancelFilter",value:function(e){this.fields=this.oldFields}},{key:"dismiss",value:function(e){this.viewCtrl.dismiss({field:e})}},{key:"close",value:function(){this.viewCtrl.dismiss()}},{key:"confirmDelete",value:function(e,t){var n=this;t.stopPropagation(),this.dialog.presentAlertConfirm("Confirmar","Estas seguro de eliminar esta cancha",(function(t){n.delete(e)}))}},{key:"delete",value:function(e){var t=this;this.modelField.api_delete(e.id).subscribe((function(n){console.log(n),"success"==n.status&&(t.dialog.showToast("Cancha Eliminada",null,"success"),t.utilArray.listDelete(t.fields,e.id))}))}},{key:"showEdit",value:function(e,t){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("showEdit"),t.stopPropagation(),n.next=3,this.modalController.create({component:k,componentProps:{id:e.id}});case 3:return(i=n.sent).onDidDismiss().then((function(e){if(e.data&&e.data.field){var t=e.data.field;o.utilArray.listUpdate(o.fields,t.id,t)}})),n.next=7,i.present();case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"show",value:function(e,t){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isSelect){n.next=2;break}return n.abrupt("return");case 2:return console.log("show"),t.stopPropagation(),n.next=5,this.modalController.create({component:w.a,componentProps:{id:e.id}});case 5:return(i=n.sent).onDidDismiss().then((function(e){})),n.next=9,i.present();case 9:return n.abrupt("return",n.sent);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"segmentChanged",value:function(e){var t=this;this.segment_select=e.detail.value,setTimeout((function(){t.regresh()}),100)}},{key:"leafletMap",value:function(){var e=this;this.map=f.map("mapId3"),this.map.on("load",(function(){console.log("load map"),setTimeout((function(){console.log("refresh"),e.regresh()}),1e3)})),this.map.setView([-27.603857971720405,-55.323644024643414],11),f.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"futbol8alem.com",id:"mapbox/streets-v11"}).addTo(this.map),this.loadFields()}},{key:"loadFields",value:function(){var e=this;this.markers.forEach((function(t){e.map&&e.map.removeLayer(t)})),this.markers=[],this.fields.forEach((function(t){e.addMarker(parseFloat(t.lat),parseFloat(t.lng),t.name)})),this.regresh()}},{key:"addMarker",value:function(e,t,n){var i=f.icon({iconUrl:"http://icons.iconseeker.com/png/fullsize/sport-fields/football-field.png",iconSize:[30,40],iconAnchor:[15,40],shadowSize:[35,50],shadowAnchor:[0,55],popupAnchor:[0,-40]});if(0!=e&&0!=t){var o=f.marker([e,t],{icon:i}).addTo(this.map).bindTooltip(n,{permanent:!0}).openTooltip();this.markers.push(o)}}},{key:"reset",value:function(){this.map&&(this.map.off(),this.map.remove())}},{key:"regresh",value:function(){this.map.invalidateSize()}}]),i}(d.a)).\u0275fac=function(e){return new(e||R)(b.Lb(p.a),b.Lb(m.a),b.Lb(h.nb),b.Lb(P.a),b.Lb(F.a),b.Lb(g.n),b.Lb(h.nb),b.Lb(m.a),b.Lb(Q.a),b.Lb(S.a))},R.\u0275cmp=b.Fb({type:R,selectors:[["app-list-fields"]],features:[b.vb],decls:19,vars:8,consts:[["slot","start"],["defaultHref","/home/teams",3,"click"],["slot","secondary"],[3,"click",4,"ngIf"],[3,"click"],["name","add-outline"],[3,"value","ionChange",4,"ngIf"],["placeholder","Filtrar Canchas","debounce","500",3,"keyup","ionClear"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["id","mapId3",2,"min-width","100%","min-height","400px !important"],["name","create-outline"],[3,"value","ionChange"],["value","list"],["value","map"],["slot","end",4,"ngIf"],["slot","end"],["slot","icon-only","name","create-outline"],["name","trash-outline"]],template:function(e,t){1&e&&(b.Qb(0,"ion-header"),b.Qb(1,"ion-toolbar"),b.Qb(2,"ion-title"),b.vc(3,"Canchas"),b.Pb(),b.Qb(4,"ion-buttons",0),b.Qb(5,"ion-back-button",1),b.Yb("click",(function(){return t.close()})),b.Pb(),b.Pb(),b.Qb(6,"ion-buttons",2),b.uc(7,C,2,0,"ion-button",3),b.Qb(8,"ion-button",4),b.Yb("click",(function(){return t.add()})),b.Mb(9,"ion-icon",5),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(10,"ion-content"),b.uc(11,M,7,1,"ion-segment",6),b.Qb(12,"ion-searchbar",7),b.Yb("keyup",(function(e){return t.filterField(e)}))("ionClear",(function(e){return t.cancelFilter(e)})),b.Pb(),b.uc(13,L,3,0,"ion-item",8),b.Qb(14,"div"),b.Qb(15,"ion-list"),b.uc(16,I,4,2,"ion-item",9),b.Pb(),b.Pb(),b.Qb(17,"div"),b.Mb(18,"div",10),b.Pb(),b.Pb()),2&e&&(b.yb(7),b.gc("ngIf","list"==t.segment_select),b.yb(4),b.gc("ngIf",!t.isSelect),b.yb(2),b.gc("ngIf",0==t.fields.length),b.yb(1),b.tc("display","list"==t.segment_select?"block":"none"),b.yb(2),b.gc("ngForOf",t.fields),b.yb(1),b.tc("display","map"!=t.segment_select||t.isSelect?"none":"block"))},directives:[h.x,h.jb,h.hb,h.j,h.f,h.g,g.l,h.i,h.y,h.r,h.T,h.vb,h.H,g.k,h.U,h.ub,h.V,h.G,h.D],styles:[""]}),R)},rLe3:function(t,n,i){"use strict";i.d(n,"a",(function(){return s}));var r=i("fXoL"),s=function(){var t=function(){function t(){o(this,t)}return a(t,[{key:"listAddLast",value:function(e,t){e.push(t)}},{key:"listAddFirst",value:function(e,t){e.unshift(t)}},{key:"listUpdate",value:function(e,t,n){var i=this.findIndexList(e,t);i>=0&&(e[i]=n)}},{key:"listDelete",value:function(e,t){var n=this.findIndexList(e,t);n>=0&&e.splice(n,1)}},{key:"findList",value:function(e,t){return e.find((function(e){return e.id===t}))}},{key:"findIndexList",value:function(e,t){return e.findIndex((function(e){return e.id===t}))}},{key:"updateAttribustesObject",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];console.log("update attributes");var o,r=e(i);try{for(r.s();!(o=r.n()).done;){var a=o.value;n.hasOwnProperty(a)&&(t[a]=n[a])}}catch(s){r.e(s)}finally{r.f()}return t}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()}}])}();