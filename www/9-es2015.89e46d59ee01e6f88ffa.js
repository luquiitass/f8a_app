(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"6/gD":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i("mrSG"),s=i("gcOT"),a=i("8xVP"),n=i("fXoL"),r=i("G/jy");const{Camera:c}=s.c;let l=(()=>{class e{constructor(e){this.photos=[],this.convertBlobToBase64=e=>new Promise((t,i)=>{const o=new FileReader;o.onerror=i,o.onload=()=>{t(o.result)},o.readAsDataURL(e)}),this.serviceImage=new a.a("Image",e)}init(e,t=!0,i="assets/images/pngwing.png"){this.url=null!=e?e:"/images/",this.thumb=null!=t&&t,this.path=i,this.photo=new b(i)}setImage(e){this.image=e,this.photo.image=e}addNewToGallery(){return Object(o.b)(this,void 0,void 0,(function*(){const e=yield c.getPhoto({resultType:s.a.Uri,source:s.b.Camera,quality:100}),t=yield this.readAsBase64(e);this.photos.unshift(new b(null,e.webPath,t,this.url,this.thumb))}))}addOneNewToGallery(){return Object(o.b)(this,void 0,void 0,(function*(){const e=yield c.getPhoto({resultType:s.a.Uri,source:s.b.Camera,quality:100}),t=yield this.readAsBase64(e);this.photo=new b(e.webPath,t,t,this.url,this.thumb,this.image)}))}isLoadPthoto(){return!!this.photo.data}readAsBase64(e){return Object(o.b)(this,void 0,void 0,(function*(){const t=yield fetch(e.webPath),i=yield t.blob();return yield this.convertBlobToBase64(i)}))}uploadImage(){if(this.isLoadPthoto())return this.photo.id?this.serviceImage.api_update(this.photo):this.serviceImage.api_create(this.photo)}}return e.\u0275fac=function(t){return new(t||e)(n.Ub(r.a))},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class b{constructor(e="assets/images/pngwing.png",t=null,i="",o="",s=!1,a=null){this.id=a?a.id:"",this.webviewPath=t,this.filepath=e,this.data=i,this.url=o,this.thumb=s,this.image=a}getPath(){return this.webviewPath?this.webviewPath:this.image&&this.image.urlComplete?this.image.urlComplete:this.filepath}}},qq2r:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var o=i("9suA"),s=i("fXoL"),a=i("TEn/"),n=i("ofXK"),r=i("EbHZ");function c(e,t){1&e&&(s.Qb(0,"ion-list-header",6),s.Qb(1,"ion-label"),s.uc(2,"No se ha encontrado equipos"),s.Pb(),s.Pb())}function l(e,t){if(1&e&&(s.Qb(0,"ion-avatar",0),s.Mb(1,"ion-img",11),s.Pb()),2&e){const e=s.ac().$implicit;s.yb(1),s.gc("src",e.shield?e.shield.urlCompleteThumb:"assets/images/esc.png")}}function b(e,t){if(1&e){const e=s.Rb();s.Qb(0,"ion-item",7),s.Yb("click",(function(){s.oc(e);const i=t.$implicit;return s.ac().dismiss(i)})),s.tc(1,l,2,1,"ion-avatar",8),s.Qb(2,"ion-label"),s.Qb(3,"h3",9),s.uc(4),s.Pb(),s.Pb(),s.Mb(5,"ion-icon",10),s.Pb()}if(2&e){const e=t.$implicit;s.yb(1),s.gc("ngIf",-1!=e.id),s.yb(3),s.vc(-1==e.id?"Registrar Nuevo Equipo ":e.name)}}let h=(()=>{class e extends o.a{constructor(e,t,i){super(t,e),this.viewCtrl=e,this.location=t,this.dataTranfer=i,this.teams=[],this.oldTeams=[],this.textSearch="",this.teams=i.getData("teams"),this.oldTeams=[...this.teams]}initObject(){}dismiss(e){this.viewCtrl.dismiss({team:e})}close(){this.viewCtrl.dismiss()}filterTeams(e){e.length<=0?this.teams=this.oldTeams:(this.teams=[...this.oldTeams],this.teams=this.teams.filter(t=>t.name.toUpperCase().includes(e.toUpperCase())||-1==t.id))}getFilter(){return this.teams.filter(e=>e.name.toUpperCase().includes(this.textSearch.toUpperCase())||-1==e.id)}cancelFilter(e){this.teams=this.oldTeams}filterChangue(e){this.textSearch=e.detail.value}log(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(a.nb),s.Lb(n.n),s.Lb(r.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-modal-filter"]],features:[s.vb],decls:12,vars:2,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["placeholder","Filtrar equipos",3,"ionClear","ionChange"],["color","tertiary",4,"ngIf"],["class","team-list",3,"click",4,"ngFor","ngForOf"],["color","tertiary"],[1,"team-list",3,"click"],["slot","start",4,"ngIf"],[1,"fs-team"],["name","chevron-forward-outline"],[3,"src"]],template:function(e,t){1&e&&(s.Qb(0,"ion-header"),s.Qb(1,"ion-toolbar"),s.Qb(2,"ion-buttons",0),s.Qb(3,"ion-button",1),s.Yb("click",(function(){return t.close()})),s.Mb(4,"ion-icon",2),s.Pb(),s.Pb(),s.Qb(5,"ion-title"),s.uc(6,"Buscar Equipo"),s.Pb(),s.Pb(),s.Pb(),s.Qb(7,"ion-content"),s.Qb(8,"ion-searchbar",3),s.Yb("ionClear",(function(e){return t.cancelFilter(e)}))("ionChange",(function(e){return t.filterChangue(e)})),s.Pb(),s.Qb(9,"ion-list"),s.tc(10,c,3,0,"ion-list-header",4),s.tc(11,b,6,2,"ion-item",5),s.Pb(),s.Pb()),2&e&&(s.yb(10),s.gc("ngIf",0==t.getFilter().length),s.yb(1),s.gc("ngForOf",t.getFilter()))},directives:[a.x,a.jb,a.j,a.i,a.y,a.hb,a.r,a.T,a.vb,a.H,n.l,n.k,a.I,a.G,a.D,a.e,a.z],styles:[""]}),e})()},z0x6:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var o=i("mrSG"),s=i("8xVP"),a=i("qq2r"),n=i("wd/R"),r=i("fXoL"),c=i("G/jy"),l=i("vuFD"),b=i("TEn/"),h=i("6/gD"),m=i("y/q6"),u=i("2Rin"),d=i("sjK5"),g=i("EbHZ"),v=i("ofXK"),f=i("3Pt+");function p(e,t){if(1&e){const e=r.Rb();r.Qb(0,"ion-button",18),r.Yb("click",(function(){return r.oc(e),r.ac().chatService.toggle()})),r.Mb(1,"ion-icon",19),r.Pb()}if(2&e){const e=r.ac();r.gc("color",e.chatService.isVisible?"success":"")}}function y(e,t){if(1&e){const e=r.Rb();r.Qb(0,"ion-item"),r.Qb(1,"ion-label",13),r.uc(2,"Nombre de equipo nuevo"),r.Pb(),r.Qb(3,"ion-input",20),r.Yb("ngModelChange",(function(t){return r.oc(e),r.ac().game.other_team=t})),r.Pb(),r.Pb()}if(2&e){const e=r.ac();r.yb(3),r.gc("ngModel",e.game.other_team)}}function P(e,t){if(1&e){const e=r.Rb();r.Qb(0,"ion-item"),r.Qb(1,"ion-label",13),r.uc(2,"Equipo Local"),r.Pb(),r.Qb(3,"ion-select",21),r.Yb("ngModelChange",(function(t){return r.oc(e),r.ac().teamLocal=t}))("ionChange",(function(t){return r.oc(e),r.ac().selectLocal(t)})),r.Qb(4,"ion-select-option",22),r.uc(5),r.Pb(),r.Qb(6,"ion-select-option",23),r.uc(7),r.Pb(),r.Pb(),r.Qb(8,"div",10),r.uc(9),r.Pb(),r.Pb()}if(2&e){const e=r.ac();r.yb(3),r.gc("ngModel",e.teamLocal)("interfaceOptions",e.customActionSheetOptions),r.yb(2),r.vc(e.teamsSelect.v.name),r.yb(2),r.vc(e.teamsSelect.l.name),r.yb(2),r.vc(e.serviceGame.errorsForm.get("v_team"))}}let w=(()=>{class e{constructor(e,t,i,o,a,n,r,c,l){var b;this.request=e,this.dialogService=t,this.viewCtrl=i,this.photoService=o,this.authUser=n,this.util=r,this.chatService=c,this.transfData=l,this.myTeams=[],this.teams=[],this.teamsSelect={v:"",l:""},this.numbGoals=[],this.customDayShortNames=["s\xf8n"],this.status=["Pendiente","Suspendido","Jugado","Created"],this.customActionSheetOptions={header:"Equipo Local"},this.myDateFilter=e=>6==e.getDay(),this.serviceGame=new s.a("Game",e),this.serviceTeam=new s.a("Team",e),this.id=a.get("id"),this.toDate=null!==(b=a.get("date"))&&void 0!==b?b:r.setFormatMoment(new Date,"YYYY-MM-DD"),console.log("date",this.toDate),this.test()}test(){console.log("day default :",n().isoWeekday()),console.log("day 4 :",n().isoWeekday(6))}ngOnInit(){this.myTeams=this.authUser.user.teams,this.teamsSelect.v=this.myTeams[0],this.serviceTeam.api_function("getAllTeamsSelect").subscribe(e=>{e.data&&(this.teams=e.data,console.log("teams -> ",this.teams),this.teams.push({id:-1,name:"Equipo nuevo"}),console.log("add Otro"))});for(var e=0;e<=30;e++)this.numbGoals.push(e);this.initObject()}initObject(){this.game={l_team:"",v_team:"",l_goals:0,v_goals:0,time:"15:00",date:this.toDate,location:"",description:"",status:"Pendiente"},this.id&&this.serviceGame.api_find(this.id).subscribe(e=>{"success"==e.status&&(this.game=e.Game)}),this.chatService.show()}submit(){return Object(o.b)(this,void 0,void 0,(function*(){this.game.date=this.util.setFormatMoment(this.game.date,"YYYY-MM-DD");try{this.valid()}catch(e){return void this.dialogService.showToast(e.message,"Error","danger")}yield this.dialogService.loadingProgres(),this.game.team_creator=this.teamsSelect.v.id,this.serviceGame.api_function("createGameAdmin",this.game).subscribe(e=>{"success"==e.status?(this.dialogService.showToast("Partido registrado"),this.dismiss(e.data)):"error"==e.status&&this.dialogService.showToast(e.errorValidaciones?e.errorValidaciones:e.mensaje,"","danger",5e3),this.dialogService.dimissLoaging()},e=>{console.log(e),this.dialogService.dimissLoaging(),this.dialogService.showToast(e.error.mensaje,"","danger",7e3)},()=>{this.dialogService.dimissLoaging()})}))}dismiss(e){this.chatService.hide(),this.viewCtrl.dismiss({game:e})}close(){this.chatService.hide(),this.viewCtrl.dismiss()}print(){console.log(this.game)}selectLocal(e){let t=e.detail.value;this.game.l_team=this.teamsSelect[t].id,this.game.v_team=this.teamsSelect["v"==t?"l":"v"].id,console.log(this.game)}clearLocal(){this.teamLocal=null,this.game.l_team="",this.game.v_team=""}valid(){if(console.log("valid Game"),!this.teamsSelect.l)throw new Error("No ha seleccionado el equipo contrario");if(this.teamsSelect.v.id==this.teamsSelect.l.id)throw new Error("Los equipos enfrentados deben ser diferentes");if(-1==this.teamsSelect.l.id&&!this.game.other_team)throw new Error("Debes a\xf1adir el nombre del Equipo Nuevo.");if(!this.teamLocal)throw new Error("Debe seleccionar el equipo local");if(!this.game.date)throw new Error("Debe seleccionar la fecha.");if(6!=n(this.game.date).isoWeekday())throw new Error("La fecha seleccionada debe ser un S\xc1BADO.")}selectTeam(e,t){return Object(o.b)(this,void 0,void 0,(function*(){this.transfData.setData("teams",e);const i=yield this.viewCtrl.create({component:a.a});i.onDidDismiss().then(e=>{const i=e.data.team;i&&(this.teamsSelect[t]=i,this.clearLocal())}),yield i.present()}))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(c.a),r.Lb(l.a),r.Lb(b.nb),r.Lb(h.a),r.Lb(b.pb),r.Lb(m.a),r.Lb(u.a),r.Lb(d.a),r.Lb(g.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-create-game-admin"]],decls:51,vars:12,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["slot","secondary"],[3,"color","click",4,"ngIf"],[3,"ngSubmit","keyup"],[3,"click"],["position","stacked"],["type","text","readonly",""],["name","chevron-forward-outline",1,"fle"],[2,"color","red","padding-top","0.2rem"],["type","text","readonly","",3,"click"],[4,"ngIf"],["position","floating"],["type","text","name","location",3,"ngModel","ngModelChange"],["displayFormat","HH:mm ","name","time",3,"ngModel","ngModelChange"],["name","date","displayFormat","DD-MM-YYYY",3,"ngModel","ngModelChange"],["type","submit","expand","block"],[3,"color","click"],["name","help-circle-outline"],["type","text","name","other_team",3,"ngModel","ngModelChange"],["name","v_team","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],["value","v"],["value","l"]],template:function(e,t){1&e&&(r.Qb(0,"ion-header"),r.Qb(1,"ion-toolbar"),r.Qb(2,"ion-title"),r.uc(3,"Nuevo Partido"),r.Pb(),r.Qb(4,"ion-buttons",0),r.Qb(5,"ion-button",1),r.Yb("click",(function(){return t.close()})),r.Mb(6,"ion-icon",2),r.Pb(),r.Pb(),r.Qb(7,"ion-buttons",3),r.tc(8,p,2,1,"ion-button",4),r.Pb(),r.Pb(),r.Pb(),r.Qb(9,"ion-content"),r.Qb(10,"form",5),r.Yb("ngSubmit",(function(){return t.submit()}))("keyup",(function(){return t.serviceGame.errorsForm.clear()})),r.Qb(11,"ion-item",6),r.Yb("click",(function(){return t.selectTeam(t.myTeams,"v")})),r.Qb(12,"ion-label",7),r.uc(13,"Mi Equipo"),r.Pb(),r.Qb(14,"ion-input",8),r.uc(15),r.Pb(),r.Mb(16,"ion-icon",9),r.Qb(17,"div",10),r.uc(18),r.Pb(),r.Pb(),r.Qb(19,"ion-item"),r.Qb(20,"ion-label",7),r.uc(21,"Contrario"),r.Pb(),r.Qb(22,"ion-input",11),r.Yb("click",(function(){return t.selectTeam(t.teams,"l")})),r.uc(23),r.Pb(),r.Mb(24,"ion-icon",9),r.Qb(25,"div",10),r.uc(26),r.Pb(),r.Pb(),r.Mb(27,"br"),r.tc(28,y,4,1,"ion-item",12),r.Qb(29,"div",10),r.uc(30),r.Pb(),r.Mb(31,"br"),r.tc(32,P,10,5,"ion-item",12),r.Mb(33,"br"),r.Qb(34,"ion-item"),r.Qb(35,"ion-label",13),r.uc(36,"Lugar"),r.Pb(),r.Qb(37,"ion-input",14),r.Yb("ngModelChange",(function(e){return t.game.location=e})),r.Pb(),r.Pb(),r.Qb(38,"div",10),r.uc(39),r.Pb(),r.Mb(40,"br"),r.Qb(41,"ion-item"),r.Qb(42,"ion-label"),r.uc(43,"HH:mm"),r.Pb(),r.Qb(44,"ion-datetime",15),r.Yb("ngModelChange",(function(e){return t.game.time=e})),r.Pb(),r.Pb(),r.Qb(45,"ion-item"),r.Qb(46,"ion-label"),r.uc(47,"Fecha"),r.Pb(),r.Qb(48,"ion-datetime",16),r.Yb("ngModelChange",(function(e){return t.game.date=e})),r.Pb(),r.Pb(),r.Qb(49,"ion-button",17),r.uc(50,"Guardar"),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.yb(8),r.gc("ngIf",t.chatService.isInit),r.yb(7),r.vc(t.teamsSelect.v?t.teamsSelect.v.name:""),r.yb(3),r.vc(t.serviceGame.errorsForm.get("l_team")),r.yb(5),r.vc(t.teamsSelect.l?t.teamsSelect.l.name:""),r.yb(3),r.vc(t.serviceGame.errorsForm.get("v_team")),r.yb(2),r.gc("ngIf",t.teamsSelect.l&&-1==t.teamsSelect.l.id),r.yb(2),r.vc(t.serviceGame.errorsForm.get("other_team")),r.yb(2),r.gc("ngIf",t.teamsSelect.v&&t.teamsSelect.l),r.yb(5),r.gc("ngModel",t.game.location),r.yb(2),r.vc(t.serviceGame.errorsForm.get("location")),r.yb(5),r.gc("ngModel",t.game.time),r.yb(4),r.gc("ngModel",t.game.date))},directives:[b.x,b.jb,b.hb,b.j,b.i,b.y,v.l,b.r,f.i,f.e,f.f,b.D,b.G,b.C,b.vb,f.d,f.g,b.s,b.ub,b.W,b.X],styles:[".fle[_ngcontent-%COMP%]{position:absolute;right:3px;top:45%}"]}),e})()}}]);