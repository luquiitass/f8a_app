(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{XDjf:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var o=i("mrSG"),n=i("4R65"),a=i("8xVP"),s=i("qsXW"),c=i("fXoL"),r=i("G/jy"),l=i("Bfh1"),u=i("m/P+"),b=i("TEn/"),d=i("ofXK");function m(e,t){if(1&e){var i=c.Rb();c.Qb(0,"div",2),c.Qb(1,"ion-button",3),c.Yb("click",(function(){return c.oc(i),c.ac().shareW()})),c.Mb(2,"ion-icon",4),c.vc(3," Enviar ubicaci\xf3n "),c.Pb(),c.Qb(4,"ion-button",3),c.Yb("click",(function(){return c.oc(i),c.ac().getRoute()})),c.Mb(5,"ion-icon",5),c.vc(6," Como llegar "),c.Pb(),c.Pb()}}var h=function(){function e(e,t,i,o){this.request=e,this.geolocation=t,this.iab=i,this.modalController=o,this.showDirection=!1,this.newMarker=null,this.position={lat:0,lng:0},this.modelField=new a.a("Field",e)}return e.prototype.ngOnInit=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.d)(this,(function(e){return this.loadField(),this.getLocation(),[2]}))}))},e.prototype.loadField=function(){var e=this;console.log("load field"),this.id&&this.modelField.api_find(this.id).subscribe((function(t){"success"==t.status&&(e.field=t.Field,e.reset(),e.leafletMap(),e.refresh())}))},e.prototype.getLocation=function(){return Object(o.b)(this,void 0,void 0,(function(){var e=this;return Object(o.d)(this,(function(t){switch(t.label){case 0:return console.log("get position"),[4,this.geolocation.getCurrentPosition({timeout:6e3}).then((function(t){console.log("resp geo",t),e.position.lat=t.coords.latitude,e.position.lng=t.coords.longitude})).catch((function(e){console.error("error geo ",e)}))];case 1:return t.sent(),this.geolocation.watchPosition().subscribe((function(e){console.log("data geo",e)})),[2]}}))}))},e.prototype.getRoute=function(){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.d)(this,(function(e){return this.comoLlegar(),[2]}))}))},e.prototype.leafletMap=function(){var e=this;this.map=n.map("mapId").setView([this.field.lat,this.field.lng],11),this.map.on("load",(function(){console.log("load map"),e.refresh()})),this.map.on("locationfound",(function(e){console.log("loc found ",e)})),this.map.on("locationerror",(function(e){console.log("loc error ",e)})),n.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"futbol-alem.com",id:"mapbox/streets-v11"}).addTo(this.map);var t=n.icon({iconUrl:"http://icons.iconseeker.com/png/fullsize/sport-fields/football-field.png",iconSize:[30,40],iconAnchor:[15,40],shadowSize:[35,50],shadowAnchor:[0,55],popupAnchor:[0,-40]});n.marker([this.field.lat,this.field.lng],{icon:t}).addTo(this.map).bindPopup(this.field.name,{permanent:!0}).openPopup(),this.refresh()},e.prototype.ngOnChanges=function(e){var t=this;console.log("changes"),e.field&&setTimeout((function(){t.map&&(t.map.off(),t.map.remove()),t.leafletMap()}))},e.prototype.refresh=function(){var e=this;setTimeout((function(){e.map.invalidateSize()}),1e3)},e.prototype.reset=function(){this.map&&(this.map.off(),this.map.remove())},e.prototype.ionViewDidLeave=function(){console.log("ionViewDidLeave component show-map"),this.reset()},e.prototype.comoLlegar=function(){this.iab.create("https://www.google.com/maps/dir/?api=1&destination="+this.field.lat+","+this.field.lng,"",{fullscreen:"yes"})},e.prototype.shareW=function(){var e=encodeURIComponent("https://www.google.com/maps/dir/?api=1&destination="+this.field.lat+","+this.field.lng);this.iab.create("https://api.whatsapp.com/send?text="+e,"",{fullscreen:"yes"})},e.prototype.show=function(e){return Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(i){switch(i.label){case 0:return console.log("show"),[4,this.modalController.create({component:s.a,componentProps:{id:e.id}})];case 1:return(t=i.sent()).onDidDismiss().then((function(e){})),[4,t.present()];case 2:return[2,i.sent()]}}))}))},e.\u0275fac=function(t){return new(t||e)(c.Lb(r.a),c.Lb(l.a),c.Lb(u.a),c.Lb(b.nb))},e.\u0275cmp=c.Fb({type:e,selectors:[["app-show-map"]],inputs:{field:"field",showDirection:"showDirection",id:"id"},features:[c.wb],decls:2,vars:4,consts:[["id","mapId",3,"click"],["class","ion-text-right",4,"ngIf"],[1,"ion-text-right"],[3,"click"],["name","logo-whatsapp"],["name","navigate-outline"]],template:function(e,t){1&e&&(c.Qb(0,"div",0),c.Yb("click",(function(){return t.show(t.field)})),c.Pb(),c.uc(1,m,7,0,"div",1)),2&e&&(c.sc("width: 100%; height: ",t.field?"300":"0","px;"),c.yb(1),c.gc("ngIf",t.showDirection&&t.field))},directives:[d.l,b.i,b.y],styles:[""]}),e}()},qq2r:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var o=i("mrSG"),n=i("9suA"),a=i("fXoL"),s=i("TEn/"),c=i("ofXK"),r=i("EbHZ");function l(e,t){1&e&&(a.Qb(0,"ion-list-header",6),a.Qb(1,"ion-label"),a.vc(2,"No se ha encontrado equipos"),a.Pb(),a.Pb())}function u(e,t){if(1&e&&(a.Qb(0,"ion-avatar",0),a.Mb(1,"ion-img",11),a.Pb()),2&e){var i=a.ac().$implicit;a.yb(1),a.gc("src",i.shield?i.shield.urlCompleteThumb:"assets/images/esc.png")}}function b(e,t){if(1&e){var i=a.Rb();a.Qb(0,"ion-item",7),a.Yb("click",(function(){a.oc(i);var e=t.$implicit;return a.ac().dismiss(e)})),a.uc(1,u,2,1,"ion-avatar",8),a.Qb(2,"ion-label"),a.Qb(3,"h3",9),a.vc(4),a.Pb(),a.Pb(),a.Mb(5,"ion-icon",10),a.Pb()}if(2&e){var o=t.$implicit;a.yb(1),a.gc("ngIf",-1!=o.id),a.yb(3),a.wc(-1==o.id?"Registrar Nuevo Equipo ":o.name)}}var d=function(e){function t(t,i,n){var a=e.call(this,i,t)||this;return a.viewCtrl=t,a.location=i,a.dataTranfer=n,a.teams=[],a.oldTeams=[],a.textSearch="",a.teams=n.getData("teams"),a.oldTeams=Object(o.f)(a.teams),a}return Object(o.c)(t,e),t.prototype.initObject=function(){},t.prototype.dismiss=function(e){this.viewCtrl.dismiss({team:e})},t.prototype.close=function(){this.viewCtrl.dismiss()},t.prototype.filterTeams=function(e){e.length<=0?this.teams=this.oldTeams:(this.teams=Object(o.f)(this.oldTeams),this.teams=this.teams.filter((function(t){return t.name.toUpperCase().includes(e.toUpperCase())||-1==t.id})))},t.prototype.getFilter=function(){var e=this;return this.teams.filter((function(t){return t.name.toUpperCase().includes(e.textSearch.toUpperCase())||-1==t.id}))},t.prototype.cancelFilter=function(e){this.teams=this.oldTeams},t.prototype.filterChangue=function(e){this.textSearch=e.detail.value},t.prototype.log=function(e){console.log(e)},t.\u0275fac=function(e){return new(e||t)(a.Lb(s.nb),a.Lb(c.n),a.Lb(r.a))},t.\u0275cmp=a.Fb({type:t,selectors:[["app-modal-filter"]],features:[a.vb],decls:12,vars:2,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["placeholder","Filtrar equipos",3,"ionClear","ionChange"],["color","tertiary",4,"ngIf"],["class","team-list",3,"click",4,"ngFor","ngForOf"],["color","tertiary"],[1,"team-list",3,"click"],["slot","start",4,"ngIf"],[1,"fs-team"],["name","chevron-forward-outline"],[3,"src"]],template:function(e,t){1&e&&(a.Qb(0,"ion-header"),a.Qb(1,"ion-toolbar"),a.Qb(2,"ion-buttons",0),a.Qb(3,"ion-button",1),a.Yb("click",(function(){return t.close()})),a.Mb(4,"ion-icon",2),a.Pb(),a.Pb(),a.Qb(5,"ion-title"),a.vc(6,"Buscar Equipo"),a.Pb(),a.Pb(),a.Pb(),a.Qb(7,"ion-content"),a.Qb(8,"ion-searchbar",3),a.Yb("ionClear",(function(e){return t.cancelFilter(e)}))("ionChange",(function(e){return t.filterChangue(e)})),a.Pb(),a.Qb(9,"ion-list"),a.uc(10,l,3,0,"ion-list-header",4),a.uc(11,b,6,2,"ion-item",5),a.Pb(),a.Pb()),2&e&&(a.yb(10),a.gc("ngIf",0==t.getFilter().length),a.yb(1),a.gc("ngForOf",t.getFilter()))},directives:[s.x,s.jb,s.j,s.i,s.y,s.hb,s.r,s.T,s.vb,s.H,c.l,c.k,s.I,s.G,s.D,s.e,s.z],styles:[""]}),t}(n.a)},z0x6:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));var o=i("mrSG"),n=i("8xVP"),a=i("qq2r"),s=i("wd/R"),c=i("fSJy"),r=i("fXoL"),l=i("G/jy"),u=i("vuFD"),b=i("TEn/"),d=i("6/gD"),m=i("y/q6"),h=i("2Rin"),f=i("sjK5"),p=i("EbHZ"),g=i("ofXK"),v=i("3Pt+"),y=i("XDjf");function w(e,t){if(1&e){var i=r.Rb();r.Qb(0,"ion-button",17),r.Yb("click",(function(){return r.oc(i),r.ac().chatService.toggle()})),r.Mb(1,"ion-icon",18),r.Pb()}if(2&e){var o=r.ac();r.gc("color",o.chatService.isVisible?"success":"")}}function P(e,t){if(1&e){var i=r.Rb();r.Qb(0,"ion-item"),r.Qb(1,"ion-label",19),r.vc(2,"Nombre de equipo nuevo"),r.Pb(),r.Qb(3,"ion-input",20),r.Yb("ngModelChange",(function(e){return r.oc(i),r.ac().game.other_team=e})),r.Pb(),r.Pb()}if(2&e){var o=r.ac();r.yb(3),r.gc("ngModel",o.game.other_team)}}function S(e,t){if(1&e){var i=r.Rb();r.Qb(0,"ion-item"),r.Qb(1,"ion-label",19),r.vc(2,"Equipo Local"),r.Pb(),r.Qb(3,"ion-select",21),r.Yb("ngModelChange",(function(e){return r.oc(i),r.ac().teamLocal=e}))("ionChange",(function(e){return r.oc(i),r.ac().selectLocal(e)})),r.Qb(4,"ion-select-option",22),r.vc(5),r.Pb(),r.Qb(6,"ion-select-option",23),r.vc(7),r.Pb(),r.Pb(),r.Qb(8,"div",10),r.vc(9),r.Pb(),r.Pb()}if(2&e){var o=r.ac();r.yb(3),r.gc("ngModel",o.teamLocal)("interfaceOptions",o.customActionSheetOptions),r.yb(2),r.wc(o.teamsSelect.v.name),r.yb(2),r.wc(o.teamsSelect.l.name),r.yb(2),r.wc(o.serviceGame.errorsForm.get("v_team"))}}function Q(e,t){if(1&e&&r.Mb(0,"app-show-map",27),2&e){var i=r.ac(2);r.gc("field",i.game.field)}}function M(e,t){if(1&e){var i=r.Rb();r.Qb(0,"ion-input",28),r.Yb("ngModelChange",(function(e){return r.oc(i),r.ac(2).game.location=e})),r.Pb()}if(2&e){var o=r.ac(2);r.gc("ngModel",o.game.location)}}function C(e,t){if(1&e){var i=r.Rb();r.Qb(0,"div",24),r.Qb(1,"ion-button",6),r.Yb("click",(function(){return r.oc(i),r.ac().selectField()})),r.vc(2),r.Pb(),r.uc(3,Q,1,1,"app-show-map",25),r.uc(4,M,1,1,"ion-input",26),r.Pb()}if(2&e){var o=r.ac();r.yb(2),r.xc("",o.game.field?"Modificar":"A\xf1adir"," ubicaci\xf3n"),r.yb(1),r.gc("ngIf",o.game.field),r.yb(1),r.gc("ngIf",!1)}}var L=function(){function e(e,t,i,o,a,s,c,r,l){var u;this.request=e,this.dialogService=t,this.viewCtrl=i,this.photoService=o,this.authUser=s,this.util=c,this.chatService=r,this.transfData=l,this.myTeams=[],this.teams=[],this.teamsSelect={v:"",l:""},this.numbGoals=[],this.customDayShortNames=["s\xf8n"],this.status=["Pendiente","Suspendido","Jugado","Created"],this.customActionSheetOptions={header:"Equipo Local"},this.myDateFilter=function(e){return 6==e.getDay()},this.serviceGame=new n.a("Game",e),this.serviceTeam=new n.a("Team",e),this.id=a.get("id"),this.toDate=null!==(u=a.get("date"))&&void 0!==u?u:c.setFormatMoment(new Date,"YYYY-MM-DD"),console.log("date",this.toDate),this.test()}return e.prototype.test=function(){console.log("day default :",s().isoWeekday()),console.log("day 4 :",s().isoWeekday(6))},e.prototype.ngOnInit=function(){var e=this;this.myTeams=this.authUser.user.teams,this.teamsSelect.v=this.myTeams[0],this.serviceTeam.api_function("getAllTeamsSelect").subscribe((function(t){t.data&&(e.teams=t.data,console.log("teams -> ",e.teams),e.teams.push({id:-1,name:"Equipo nuevo"}),console.log("add Otro"))}));for(var t=0;t<=30;t++)this.numbGoals.push(t);this.initObject()},e.prototype.initObject=function(){var e=this;this.game={l_team:"",v_team:"",l_goals:0,v_goals:0,time:"15:00",date:this.toDate,location:"",description:"",status:"Pendiente",field:null,field_id:""},this.id&&this.serviceGame.api_find(this.id).subscribe((function(t){"success"==t.status&&(e.game=t.Game)}))},e.prototype.submit=function(){return Object(o.b)(this,void 0,void 0,(function(){var e=this;return Object(o.d)(this,(function(t){switch(t.label){case 0:this.game.date=this.util.setFormatMoment(this.game.date,"YYYY-MM-DD");try{this.valid()}catch(i){return this.dialogService.showToast(i.message,"Error","danger"),[2]}return[4,this.dialogService.loadingProgres()];case 1:return t.sent(),this.game.team_creator=this.teamsSelect.v.id,this.serviceGame.api_function("createGameAdmin",this.game).subscribe((function(t){"success"==t.status?(e.dialogService.showToast("Partido registrado"),e.dismiss(t.data)):"error"==t.status&&e.dialogService.showToast(t.errorValidaciones?t.errorValidaciones:t.mensaje,"","danger",5e3),e.dialogService.dimissLoaging()}),(function(t){console.log(t),e.dialogService.dimissLoaging(),e.dialogService.showToast(t.error.mensaje,"","danger",7e3)}),(function(){e.dialogService.dimissLoaging()})),[2]}}))}))},e.prototype.dismiss=function(e){this.chatService.hide(),this.viewCtrl.dismiss({game:e})},e.prototype.close=function(){this.chatService.hide(),this.viewCtrl.dismiss()},e.prototype.print=function(){console.log(this.game)},e.prototype.selectLocal=function(e){var t=e.detail.value;this.game.l_team=this.teamsSelect[t].id,this.game.v_team=this.teamsSelect["v"==t?"l":"v"].id,this.teamsSelect[t]&&this.setField(this.teamsSelect[t].field),console.log(this.game)},e.prototype.clearLocal=function(){this.teamLocal=null,this.game.l_team="",this.game.v_team=""},e.prototype.valid=function(){if(console.log("valid Game"),!this.teamsSelect.l)throw new Error("No ha seleccionado el equipo contrario");if(this.teamsSelect.v.id==this.teamsSelect.l.id)throw new Error("Los equipos enfrentados deben ser diferentes");if(-1==this.teamsSelect.l.id&&!this.game.other_team)throw new Error("Debes a\xf1adir el nombre del Equipo Nuevo.");if(!this.teamLocal)throw new Error("Debe seleccionar el equipo local");if(!this.game.date)throw new Error("Debe seleccionar la fecha.");if(6!=s(this.game.date).isoWeekday()&&1==this.authUser.user.category_id)throw new Error("La fecha seleccionada debe ser de un S\xc1BADO.")},e.prototype.selectTeam=function(e,t){return Object(o.b)(this,void 0,void 0,(function(){var i,n=this;return Object(o.d)(this,(function(o){switch(o.label){case 0:return this.transfData.setData("teams",e),[4,this.viewCtrl.create({component:a.a})];case 1:return(i=o.sent()).onDidDismiss().then((function(e){var i=e.data.team;i&&(n.teamsSelect[t]=i,n.clearLocal())})),[4,i.present()];case 2:return o.sent(),[2]}}))}))},e.prototype.selectField=function(){return Object(o.b)(this,void 0,void 0,(function(){var e,t=this;return Object(o.d)(this,(function(i){switch(i.label){case 0:return this.transfData.setData("isSelect",!0),[4,this.viewCtrl.create({component:c.a})];case 1:return(e=i.sent()).onDidDismiss().then((function(e){console.log("close modal select field"),e.data&&e.data.field&&t.setField(e.data.field)})),[4,e.present()];case 2:return i.sent(),[2]}}))}))},e.prototype.setField=function(e){e?(this.game.field=e,this.game.field_id=e.id):(this.game.field=null,this.game.field_id=null)},e.\u0275fac=function(t){return new(t||e)(r.Lb(l.a),r.Lb(u.a),r.Lb(b.nb),r.Lb(d.a),r.Lb(b.pb),r.Lb(m.a),r.Lb(h.a),r.Lb(f.a),r.Lb(p.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-create-game-admin"]],decls:48,vars:12,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["slot","secondary"],[3,"color","click",4,"ngIf"],[3,"ngSubmit","keyup"],[3,"click"],["position","stacked"],["type","text","readonly",""],["name","chevron-forward-outline",1,"fle"],[2,"color","red","padding-top","0.2rem"],["type","text","readonly","",3,"click"],[4,"ngIf"],["class","ion-text-center",4,"ngIf"],["displayFormat","HH:mm ","name","time",3,"ngModel","ngModelChange"],["name","date","displayFormat","DD-MM-YYYY",3,"ngModel","ngModelChange"],["type","submit","expand","block"],[3,"color","click"],["name","help-circle-outline"],["position","floating"],["type","text","name","other_team",3,"ngModel","ngModelChange"],["name","v_team","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],["value","v"],["value","l"],[1,"ion-text-center"],[3,"field",4,"ngIf"],["type","text","name","location",3,"ngModel","ngModelChange",4,"ngIf"],[3,"field"],["type","text","name","location",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.Qb(0,"ion-header"),r.Qb(1,"ion-toolbar"),r.Qb(2,"ion-title"),r.vc(3,"Nuevo Partido"),r.Pb(),r.Qb(4,"ion-buttons",0),r.Qb(5,"ion-button",1),r.Yb("click",(function(){return t.close()})),r.Mb(6,"ion-icon",2),r.Pb(),r.Pb(),r.Qb(7,"ion-buttons",3),r.uc(8,w,2,1,"ion-button",4),r.Pb(),r.Pb(),r.Pb(),r.Qb(9,"ion-content"),r.Qb(10,"form",5),r.Yb("ngSubmit",(function(){return t.submit()}))("keyup",(function(){return t.serviceGame.errorsForm.clear()})),r.Qb(11,"ion-item",6),r.Yb("click",(function(){return t.selectTeam(t.myTeams,"v")})),r.Qb(12,"ion-label",7),r.vc(13,"Mi Equipo"),r.Pb(),r.Qb(14,"ion-input",8),r.vc(15),r.Pb(),r.Mb(16,"ion-icon",9),r.Qb(17,"div",10),r.vc(18),r.Pb(),r.Pb(),r.Qb(19,"ion-item"),r.Qb(20,"ion-label",7),r.vc(21,"Contrario"),r.Pb(),r.Qb(22,"ion-input",11),r.Yb("click",(function(){return t.selectTeam(t.teams,"l")})),r.vc(23),r.Pb(),r.Mb(24,"ion-icon",9),r.Qb(25,"div",10),r.vc(26),r.Pb(),r.Pb(),r.Mb(27,"br"),r.uc(28,P,4,1,"ion-item",12),r.Qb(29,"div",10),r.vc(30),r.Pb(),r.Mb(31,"br"),r.uc(32,S,10,5,"ion-item",12),r.Mb(33,"br"),r.uc(34,C,5,3,"div",13),r.Qb(35,"div",10),r.vc(36),r.Pb(),r.Mb(37,"br"),r.Qb(38,"ion-item"),r.Qb(39,"ion-label"),r.vc(40,"HH:mm"),r.Pb(),r.Qb(41,"ion-datetime",14),r.Yb("ngModelChange",(function(e){return t.game.time=e})),r.Pb(),r.Pb(),r.Qb(42,"ion-item"),r.Qb(43,"ion-label"),r.vc(44,"Fecha"),r.Pb(),r.Qb(45,"ion-datetime",15),r.Yb("ngModelChange",(function(e){return t.game.date=e})),r.Pb(),r.Pb(),r.Qb(46,"ion-button",16),r.vc(47,"Guardar"),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.yb(8),r.gc("ngIf",t.chatService.isInit),r.yb(7),r.wc(t.teamsSelect.v?t.teamsSelect.v.name:""),r.yb(3),r.wc(t.serviceGame.errorsForm.get("l_team")),r.yb(5),r.wc(t.teamsSelect.l?t.teamsSelect.l.name:""),r.yb(3),r.wc(t.serviceGame.errorsForm.get("v_team")),r.yb(2),r.gc("ngIf",t.teamsSelect.l&&-1==t.teamsSelect.l.id),r.yb(2),r.wc(t.serviceGame.errorsForm.get("other_team")),r.yb(2),r.gc("ngIf",t.teamsSelect.v&&t.teamsSelect.l),r.yb(2),r.gc("ngIf",t.teamLocal),r.yb(2),r.wc(t.serviceGame.errorsForm.get("location")),r.yb(5),r.gc("ngModel",t.game.time),r.yb(4),r.gc("ngModel",t.game.date))},directives:[b.x,b.jb,b.hb,b.j,b.i,b.y,g.l,b.r,v.i,v.e,v.f,b.D,b.G,b.C,b.vb,b.s,b.ub,v.d,v.g,b.W,b.X,y.a],styles:[".fle[_ngcontent-%COMP%]{position:absolute;right:3px;top:45%}"]}),e}()}}]);